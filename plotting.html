<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.37">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>WIO-fish - 6&nbsp; Plotting in R with ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./eda.html" rel="next">
<link href="./dataManipulation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plotting in R with <code>ggplot2</code></span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./FAO_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">WIO-fish</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/lugoga/ecasData" title="Source Code" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Rlanguage.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Software and Tools</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataTypes.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Data Structure in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Reading data into R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dataManipulation.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulating Data with <strong>dplyr</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plotting.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plotting in R with <code>ggplot2</code></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory-Data-Analysis-EDA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./outlier.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Detect Outlier(s)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Simple and Multiple linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regressionMultiple.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regressionGAM.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Generalized Additive Models</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesisTesting.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Descriptive versus inferential statistics</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./onesample.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">One sample test</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ttest.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Two Independent Samples-parametric</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./wilcoxon.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Two Independent Samples Non-parametric</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Analysis of Variance (ANOVA)</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./kwanova.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Kruskal-Wallis test, or the nonparametric version of the ANOVA</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chisquare.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Chi-square test of independence in R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lbspr.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Length Based Spawning Potential Ratio</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./maps.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Static Maps</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./mapsDynamic.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Animated maps</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Appendices</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./keyobjects.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Key objects</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#a-dataset" id="toc-a-dataset" class="nav-link active" data-scroll-target="#a-dataset"> <span class="header-section-number">6.1</span> A dataset</a></li>
  <li><a href="#components-of-ggplot-objects-components" id="toc-components-of-ggplot-objects-components" class="nav-link" data-scroll-target="#components-of-ggplot-objects-components"> <span class="header-section-number">6.2</span> Components of ggplot objects {components}</a></li>
  <li><a href="#building-a-plot" id="toc-building-a-plot" class="nav-link" data-scroll-target="#building-a-plot"> <span class="header-section-number">6.3</span> Building a plot</a>
  <ul class="collapse">
  <li><a href="#plotting-layers" id="toc-plotting-layers" class="nav-link" data-scroll-target="#plotting-layers"> <span class="header-section-number">6.3.1</span> Plotting layers</a></li>
  <li><a href="#customize-legend" id="toc-customize-legend" class="nav-link" data-scroll-target="#customize-legend"> <span class="header-section-number">6.3.2</span> Customize legend</a></li>
  <li><a href="#working-with-titles-and-labels" id="toc-working-with-titles-and-labels" class="nav-link" data-scroll-target="#working-with-titles-and-labels"> <span class="header-section-number">6.3.3</span> Working with titles and labels</a></li>
  </ul></li>
  <li><a href="#customize-glidline-and-axis-labels" id="toc-customize-glidline-and-axis-labels" class="nav-link" data-scroll-target="#customize-glidline-and-axis-labels"> <span class="header-section-number">6.4</span> Customize glidline and axis labels</a>
  <ul class="collapse">
  <li><a href="#remove-the-gray-box-of-points-on-legend" id="toc-remove-the-gray-box-of-points-on-legend" class="nav-link" data-scroll-target="#remove-the-gray-box-of-points-on-legend"> <span class="header-section-number">6.4.1</span> Remove the gray box of points on legend</a></li>
  </ul></li>
  <li><a href="#modify-the-position-of-the-legend" id="toc-modify-the-position-of-the-legend" class="nav-link" data-scroll-target="#modify-the-position-of-the-legend"> <span class="header-section-number">6.5</span> Modify the position of the legend</a>
  <ul class="collapse">
  <li><a href="#change-the-legend-background-and-stroke-color" id="toc-change-the-legend-background-and-stroke-color" class="nav-link" data-scroll-target="#change-the-legend-background-and-stroke-color"> <span class="header-section-number">6.5.1</span> Change the legend background and stroke color</a></li>
  <li><a href="#modify-background-colors" id="toc-modify-background-colors" class="nav-link" data-scroll-target="#modify-background-colors"> <span class="header-section-number">6.5.2</span> Modify background colors</a></li>
  <li><a href="#change-the-gridlines" id="toc-change-the-gridlines" class="nav-link" data-scroll-target="#change-the-gridlines"> <span class="header-section-number">6.5.3</span> change the gridlines</a></li>
  <li><a href="#change-the-font-size-for-axis-labels-and-titles" id="toc-change-the-font-size-for-axis-labels-and-titles" class="nav-link" data-scroll-target="#change-the-font-size-for-axis-labels-and-titles"> <span class="header-section-number">6.5.4</span> Change the font size for axis, labels and titles</a></li>
  <li><a href="#limit-axis-to-a-range" id="toc-limit-axis-to-a-range" class="nav-link" data-scroll-target="#limit-axis-to-a-range"> <span class="header-section-number">6.5.5</span> Limit axis to a range</a></li>
  <li><a href="#adding-labels" id="toc-adding-labels" class="nav-link" data-scroll-target="#adding-labels"> <span class="header-section-number">6.5.6</span> Adding labels</a></li>
  <li><a href="#add-text-annotation" id="toc-add-text-annotation" class="nav-link" data-scroll-target="#add-text-annotation"> <span class="header-section-number">6.5.7</span> Add text annotation</a></li>
  <li><a href="#make-the-x-and-y-axis-the-same" id="toc-make-the-x-and-y-axis-the-same" class="nav-link" data-scroll-target="#make-the-x-and-y-axis-the-same"> <span class="header-section-number">6.5.8</span> Make the x and y axis the same</a></li>
  <li><a href="#faceting-creating-multipanel-plots" id="toc-faceting-creating-multipanel-plots" class="nav-link" data-scroll-target="#faceting-creating-multipanel-plots"> <span class="header-section-number">6.5.9</span> Faceting —Creating multi–panel plots</a></li>
  <li><a href="#allow-scales-to-roam-free-scales" id="toc-allow-scales-to-roam-free-scales" class="nav-link" data-scroll-target="#allow-scales-to-roam-free-scales"> <span class="header-section-number">6.5.10</span> Allow scales to roam free (scales)</a></li>
  </ul></li>
  <li><a href="#basic-plots" id="toc-basic-plots" class="nav-link" data-scroll-target="#basic-plots"> <span class="header-section-number">6.6</span> Basic plots</a>
  <ul class="collapse">
  <li><a href="#scatterplot" id="toc-scatterplot" class="nav-link" data-scroll-target="#scatterplot"> <span class="header-section-number">6.6.1</span> scatterplot</a></li>
  <li><a href="#adding-regression-line" id="toc-adding-regression-line" class="nav-link" data-scroll-target="#adding-regression-line"> <span class="header-section-number">6.6.2</span> adding regression line</a></li>
  </ul></li>
  <li><a href="#linegraph" id="toc-linegraph" class="nav-link" data-scroll-target="#linegraph"> <span class="header-section-number">6.7</span> Linegraph</a>
  <ul class="collapse">
  <li><a href="#histogram" id="toc-histogram" class="nav-link" data-scroll-target="#histogram"> <span class="header-section-number">6.7.1</span> histogram</a></li>
  <li><a href="#boxplot" id="toc-boxplot" class="nav-link" data-scroll-target="#boxplot"> <span class="header-section-number">6.7.2</span> boxplot</a></li>
  <li><a href="#barplot" id="toc-barplot" class="nav-link" data-scroll-target="#barplot"> <span class="header-section-number">6.7.3</span> barplot</a></li>
  <li><a href="#barplot-for-values" id="toc-barplot-for-values" class="nav-link" data-scroll-target="#barplot-for-values"> <span class="header-section-number">6.7.4</span> barplot for values</a></li>
  </ul></li>
  <li><a href="#advanced-plots" id="toc-advanced-plots" class="nav-link" data-scroll-target="#advanced-plots"> <span class="header-section-number">6.8</span> Advanced plots</a>
  <ul class="collapse">
  <li><a href="#facets" id="toc-facets" class="nav-link" data-scroll-target="#facets"> <span class="header-section-number">6.8.1</span> Facets</a></li>
  <li><a href="#sea-surface-temperature" id="toc-sea-surface-temperature" class="nav-link" data-scroll-target="#sea-surface-temperature"> <span class="header-section-number">6.8.2</span> Sea Surface Temperature</a></li>
  <li><a href="#subplot" id="toc-subplot" class="nav-link" data-scroll-target="#subplot"> <span class="header-section-number">6.8.3</span> Subplot</a></li>
  </ul></li>
  <li><a href="#colour" id="toc-colour" class="nav-link" data-scroll-target="#colour"> <span class="header-section-number">6.9</span> Colour</a></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"> <span class="header-section-number">6.10</span> size</a></li>
  <li><a href="#scaling" id="toc-scaling" class="nav-link" data-scroll-target="#scaling"> <span class="header-section-number">6.11</span> scaling</a></li>
  <li><a href="#guides" id="toc-guides" class="nav-link" data-scroll-target="#guides"> <span class="header-section-number">6.12</span> Guides</a></li>
  <li><a href="#add-on-packages" id="toc-add-on-packages" class="nav-link" data-scroll-target="#add-on-packages"> <span class="header-section-number">6.13</span> Add-on packages</a></li>
  <li><a href="#ggridges" id="toc-ggridges" class="nav-link" data-scroll-target="#ggridges"> <span class="header-section-number">6.14</span> ggridges</a></li>
  <li><a href="#varying-fill-colors-along-the-x-axis" id="toc-varying-fill-colors-along-the-x-axis" class="nav-link" data-scroll-target="#varying-fill-colors-along-the-x-axis"> <span class="header-section-number">6.15</span> Varying fill colors along the x axis</a></li>
  <li><a href="#metr" id="toc-metr" class="nav-link" data-scroll-target="#metr"> <span class="header-section-number">6.16</span> metR</a></li>
  <li><a href="#a-grammar-for-graphics" id="toc-a-grammar-for-graphics" class="nav-link" data-scroll-target="#a-grammar-for-graphics"> <span class="header-section-number">6.17</span> A grammar for graphics</a>
  <ul class="collapse">
  <li><a href="#regression-line" id="toc-regression-line" class="nav-link" data-scroll-target="#regression-line"> <span class="header-section-number">6.17.1</span> Regression Line</a></li>
  <li><a href="#horizontal-vertical-lines" id="toc-horizontal-vertical-lines" class="nav-link" data-scroll-target="#horizontal-vertical-lines"> <span class="header-section-number">6.17.2</span> Horizontal/ vertical lines</a></li>
  </ul></li>
  <li><a href="#aes" id="toc-aes" class="nav-link" data-scroll-target="#aes"> <span class="header-section-number">6.18</span> aes()</a>
  <ul class="collapse">
  <li><a href="#color" id="toc-color" class="nav-link" data-scroll-target="#color"> <span class="header-section-number">6.18.1</span> Color</a></li>
  <li><a href="#shape" id="toc-shape" class="nav-link" data-scroll-target="#shape"> <span class="header-section-number">6.18.2</span> shape</a></li>
  </ul></li>
  <li><a href="#axis-and-labels" id="toc-axis-and-labels" class="nav-link" data-scroll-target="#axis-and-labels"> <span class="header-section-number">6.19</span> Axis and labels</a></li>
  <li><a href="#axis-range" id="toc-axis-range" class="nav-link" data-scroll-target="#axis-range"> <span class="header-section-number">6.20</span> Axis Range</a></li>
  <li><a href="#text-annotaion" id="toc-text-annotaion" class="nav-link" data-scroll-target="#text-annotaion"> <span class="header-section-number">6.21</span> Text annotaion</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"> <span class="header-section-number">6.22</span> Scales</a></li>
  <li><a href="#guides-1" id="toc-guides-1" class="nav-link" data-scroll-target="#guides-1"> <span class="header-section-number">6.23</span> Guides</a></li>
  <li><a href="#themes" id="toc-themes" class="nav-link" data-scroll-target="#themes"> <span class="header-section-number">6.24</span> Themes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Plotting in R with <code>ggplot2</code></span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><strong>ggplot2</strong> is a package we’ll be using a lot for graphing our education datasets. <strong>ggplot2</strong> is designed to build graphs layer by layer, where each layer is a building block for your graph. Making graphs in layers is useful because we can think of building up our graphs in separate parts: the data comes first, then the x-axis and y-axis, and finally other components like text labels and graph shapes. When something goes wrong and your <strong>ggplot2</strong> code returns an error, you can learn about what’s happening by removing one layer at a time and running it again until the code works properly. Once you know which line is causing the problem, you can focus on fixing it.</p>
<p>The ability to create visualizations—graphical representations of data is an important step to convey your results—information and findings to others. In this chapter, we illustrate how you can use visualize your data and create elegant graphics. One of things that makes R such a great tools is it’s data visualization capabilities. R has many systems for visualization and creating plots, some of which are—base R graphics, <strong>lattice</strong> and <strong>ggplot2</strong>, but we focus on the use of <strong>ggplot2</strong>. The <strong>ggplot2</strong> package is a phenomenal tool for creating graphics in R. It provide a unifying framework—a <em>grammar of graphics</em> for describing and building graphs.</p>
<p>Just as the <em>grammar of language</em> helps you construct meaningful sentences out of words, the <em>Grammar of Graphics</em> helps you construct graphics out of different visual elements. This grammar provides a way to talk about parts of a visual plot: all the circles, lines, arrows, and text that are combined into a diagram for visualizing data. Originally developed by Leland Wilkinson, the Grammar of Graphics was adapted by Hadley Wickham <span class="citation" data-cites="ggplot">(<a href="#ref-ggplot" role="doc-biblioref">2016</a>)</span> to describe the components of a plot</p>
<p>The <strong>ggplot2</strong> package provides a powerful and flexible approach to data visualization, and its is suitable both for rapdi exploration of different visualization approaches and for producing carefully crafted publication–quality figures. However, getting ggplot2 to make figures that look exactly the way you want them to, can sometimes be challenging and beginners and expert alike can get consufed by themes, scales, coords, guides or facets. <strong>ggplot2</strong> further organizes these components into layers, where each layer displays a single type of (highly configurable) geometric object.</p>
<p>Even the most experienced R users need to refer to <strong>ggplot2</strong> Cheat Sheet while creating elegant graphics, we will demonstrate step–by–step how to get the most out of <strong>ggplot2</strong> package, including how to choose and customize scales, how to theme plots, and when to use add-in packages that extend the <strong>ggplot2</strong> capabilities. Some of the extension of <strong>ggplot2</strong> that we will introuduce to your include <strong>ggspatial</strong> <span class="citation" data-cites="ggspatial">(<a href="#ref-ggspatial" role="doc-biblioref"><strong>ggspatial?</strong></a>)</span>, <strong>metR</strong> <span class="citation" data-cites="metr">(<a href="#ref-metr" role="doc-biblioref">Campitelli 2021</a>)</span>, <strong>ggrepel</strong> <span class="citation" data-cites="ggrepel">(<a href="#ref-ggrepel" role="doc-biblioref"><strong>ggrepel?</strong></a>)</span>, <strong>cowplot</strong> <span class="citation" data-cites="cowplot">(<a href="#ref-cowplot" role="doc-biblioref">Wilke 2018</a>)</span>, <strong>patchwork</strong> <span class="citation" data-cites="patchwork">(<a href="#ref-patchwork" role="doc-biblioref">Pedersen 2020</a>)</span>, etc. Rather than loading these extension packages with <code>require()</code> function, we’ll call their functions using the <code>::</code> notation. This will help make it clear which funcions are built into <strong>ggplot2</strong>, and which comes from extensions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>load addition functions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"assets//semba_functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<section id="a-dataset" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="a-dataset"><span class="header-section-number">6.1</span> A dataset</h2>
<p>We’re using a CTD profile data along the coastal water of Tanzania collected in August 2004 with Algoa. I have processed and cleaned the profile data from a CTD instrument, and created a very basic and simple dataset for us to start with. I have tidy the data into a data frame and it contains 10 variables collected at 22 stations (<a href="#tbl-algoa">Table&nbsp;<span class="quarto-unresolved-ref">tbl-algoa</span></a>). These variables include the <code>time</code>, <code>longitude</code> and <code>latitude</code> coordinates and the <code>name</code> at each station. It also contains the measured profile of <code>temperature</code>, <code>salinity</code>, <code>oxygen</code>, and <code>fluorescence</code>, <code>spar</code>, <code>par</code> and <code>density</code> as function of <code>pressure.</code></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2796 Columns: 12
-- Column specification --------------------------------------------------------
Delimiter: ","
chr   (1): station
dbl  (10): lon, lat, pressure, temperature, salinity, oxygen, fluorescence, ...
dttm  (1): time

i Use `spec()` to retrieve the full column specification for this data.
i Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-algoa" class="anchored">

<table><caption>Table 6.1:  A sample of CTD profile dataset. For visibility of all the 22 stations, only variables measured at 5 meter standard depth are shown </caption>
 <thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1"></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Cast Time</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Cast Location</div></th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">Measured Variabes</div></th>
</tr>
  <tr>
   <th style="text-align:left;"> Station </th>
   <th style="text-align:left;"> Date </th>
   <th style="text-align:right;"> Hour </th>
   <th style="text-align:right;"> Lon </th>
   <th style="text-align:right;"> Lat </th>
   <th style="text-align:right;"> Pressure </th>
   <th style="text-align:right;"> Temperature </th>
   <th style="text-align:right;"> Salinity </th>
   <th style="text-align:right;"> Oxygen </th>
   <th style="text-align:right;"> Fluorescence </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;width: 2cm; "> st1 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-18 </td>
   <td style="text-align:right;width: 2cm; "> 15 </td>
   <td style="text-align:right;width: 2cm; "> 40.61 </td>
   <td style="text-align:right;width: 2cm; "> -10.54 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.17 </td>
   <td style="text-align:right;width: 2.5cm; "> 33.92 </td>
   <td style="text-align:right;width: 2.5cm; "> 3.93 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.56 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st2 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-18 </td>
   <td style="text-align:right;width: 2cm; "> 17 </td>
   <td style="text-align:right;width: 2cm; "> 40.77 </td>
   <td style="text-align:right;width: 2cm; "> -10.54 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.16 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.85 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.47 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.62 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st3 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-18 </td>
   <td style="text-align:right;width: 2cm; "> 20 </td>
   <td style="text-align:right;width: 2cm; "> 40.95 </td>
   <td style="text-align:right;width: 2cm; "> -10.54 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st4 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-18 </td>
   <td style="text-align:right;width: 2cm; "> 22 </td>
   <td style="text-align:right;width: 2cm; "> 41.12 </td>
   <td style="text-align:right;width: 2cm; "> -10.54 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st5 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 0 </td>
   <td style="text-align:right;width: 2cm; "> 41.28 </td>
   <td style="text-align:right;width: 2cm; "> -10.54 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st6 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 11 </td>
   <td style="text-align:right;width: 2cm; "> 40.34 </td>
   <td style="text-align:right;width: 2cm; "> -8.83 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.21 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.86 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.48 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.24 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st7 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 13 </td>
   <td style="text-align:right;width: 2cm; "> 40.18 </td>
   <td style="text-align:right;width: 2cm; "> -8.83 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.25 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.87 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.52 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.44 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st8 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 15 </td>
   <td style="text-align:right;width: 2cm; "> 40.00 </td>
   <td style="text-align:right;width: 2cm; "> -8.83 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.02 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.86 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.59 </td>
   <td style="text-align:right;width: 2.5cm; "> 1.14 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st9 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 17 </td>
   <td style="text-align:right;width: 2cm; "> 39.82 </td>
   <td style="text-align:right;width: 2cm; "> -8.83 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.11 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.86 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.64 </td>
   <td style="text-align:right;width: 2.5cm; "> 1.53 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st10 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-19 </td>
   <td style="text-align:right;width: 2cm; "> 19 </td>
   <td style="text-align:right;width: 2cm; "> 39.67 </td>
   <td style="text-align:right;width: 2cm; "> -8.83 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
   <td style="text-align:right;width: 2.5cm; "> NA </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st11 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-22 </td>
   <td style="text-align:right;width: 2cm; "> 16 </td>
   <td style="text-align:right;width: 2cm; "> 39.60 </td>
   <td style="text-align:right;width: 2cm; "> -9.03 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.44 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.91 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.98 </td>
   <td style="text-align:right;width: 2.5cm; "> 1.71 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st12 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 3 </td>
   <td style="text-align:right;width: 2cm; "> 40.26 </td>
   <td style="text-align:right;width: 2cm; "> -7.04 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.12 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.87 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.50 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.99 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st13 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 6 </td>
   <td style="text-align:right;width: 2cm; "> 40.10 </td>
   <td style="text-align:right;width: 2cm; "> -7.05 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.18 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.87 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.49 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.45 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st14 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 7 </td>
   <td style="text-align:right;width: 2cm; "> 39.93 </td>
   <td style="text-align:right;width: 2cm; "> -7.05 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.28 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.88 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.60 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.84 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st15 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 9 </td>
   <td style="text-align:right;width: 2cm; "> 39.76 </td>
   <td style="text-align:right;width: 2cm; "> -7.04 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.26 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.89 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.66 </td>
   <td style="text-align:right;width: 2.5cm; "> 1.06 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st16 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 11 </td>
   <td style="text-align:right;width: 2cm; "> 39.59 </td>
   <td style="text-align:right;width: 2cm; "> -7.04 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.92 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.88 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.31 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.62 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st17 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 19 </td>
   <td style="text-align:right;width: 2cm; "> 40.07 </td>
   <td style="text-align:right;width: 2cm; "> -5.49 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.64 </td>
   <td style="text-align:right;width: 2.5cm; "> 35.19 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.40 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.82 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st18 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-23 </td>
   <td style="text-align:right;width: 2cm; "> 22 </td>
   <td style="text-align:right;width: 2cm; "> 39.90 </td>
   <td style="text-align:right;width: 2cm; "> -5.49 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.28 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.90 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.52 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.85 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st19 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-24 </td>
   <td style="text-align:right;width: 2cm; "> 1 </td>
   <td style="text-align:right;width: 2cm; "> 39.56 </td>
   <td style="text-align:right;width: 2cm; "> -5.49 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.27 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.90 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.53 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.98 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st20 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-24 </td>
   <td style="text-align:right;width: 2cm; "> 3 </td>
   <td style="text-align:right;width: 2cm; "> 39.40 </td>
   <td style="text-align:right;width: 2cm; "> -5.47 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.23 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.89 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.81 </td>
   <td style="text-align:right;width: 2.5cm; "> 1.11 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st21 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-24 </td>
   <td style="text-align:right;width: 2cm; "> 4 </td>
   <td style="text-align:right;width: 2cm; "> 39.24 </td>
   <td style="text-align:right;width: 2cm; "> -5.48 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 25.82 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.93 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.34 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.21 </td>
  </tr>
  <tr>
   <td style="text-align:left;width: 2cm; "> st22 </td>
   <td style="text-align:left;width: 2cm; "> 2004-08-24 </td>
   <td style="text-align:right;width: 2cm; "> 5 </td>
   <td style="text-align:right;width: 2cm; "> 39.10 </td>
   <td style="text-align:right;width: 2cm; "> -5.48 </td>
   <td style="text-align:right;width: 2.5cm; "> 5 </td>
   <td style="text-align:right;width: 2.5cm; "> 26.05 </td>
   <td style="text-align:right;width: 2.5cm; "> 34.95 </td>
   <td style="text-align:right;width: 2.5cm; "> 4.32 </td>
   <td style="text-align:right;width: 2.5cm; "> 0.42 </td>
  </tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## make a variable with labelled latitude</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ctd <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">transect =</span> <span class="st">"transect 1"</span>, <span class="at">Lat.label =</span> <span class="fu">median</span>(lat)) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">8</span> <span class="sc">&amp;</span> lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">transect =</span> <span class="st">"transect 2"</span>, <span class="at">Lat.label =</span> <span class="fu">median</span>(lat)),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&gt;</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">&amp;</span> lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">8</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">transect =</span> <span class="st">"transect 3"</span>, <span class="at">Lat.label =</span> <span class="fu">median</span>(lat)),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">transect =</span> <span class="st">"transect 4"</span>,  <span class="at">Lat.label =</span> <span class="fu">median</span>(lat))) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Lat.label =</span> metR<span class="sc">::</span><span class="fu">LatLabel</span>(Lat.label<span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>)) <span class="sc">%&gt;%</span><span class="fu">as.factor</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="components-of-ggplot-objects-components" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="components-of-ggplot-objects-components"><span class="header-section-number">6.2</span> Components of ggplot objects {components}</h2>
<p>I have created a simple plot of this data that show scatterplot of temperature versus fluorescence at the four different transects (<a href="#fig-fig12">Figure&nbsp;<span class="quarto-unresolved-ref">fig-fig12</span></a>). The plot show the concentration of fluorescence against temperature for the twenty one stations along the coastal water of Tanzania.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>),</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-fig12" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-fig12-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 6.1: Association of fluorescence concentration per temperature collected in August 2004 standard depth are shown</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Let’s explore in details the key elements used to make figure @ref(fig:fig1299):</p>
<ul>
<li><strong>data</strong>: The data like the one illustrated in table @ref(tab:tabE01). It must be a data frame for ggplot2 read and understand.</li>
<li><strong>aesthetics</strong>: is used to map the <code>x</code> and <code>y</code> axis for 2–dimensional plot and add the <code>z</code> value for 3–dimensionla plots. It is also used to define visual properties like color, size, shapes or height etc, and. For instance in the figure @ref(fig:fig1299), the position along the <code>y</code>-axis is mapped to the concentration of fluorescence and the <code>x</code> - axis is mapped to temperature values. For the points, the color is mapped to the geogrphical location along the transects. Other aesthetics—like size, shape, and transparency have been left at their default settings.</li>
<li><strong>geometry</strong>; a layer which define the type of plot you want to make, whether is <code>histogram</code>, <code>boxplot</code>, <code>barplot</code>, <code>scatterplot</code>, <code>lineplot</code> etc.</li>
<li><strong>coordinate system</strong>: used to set a limit for the plot. The cartesian coordinate is the most familiar and common system that is widely used to zoom the plot and does not change the underlying data.</li>
<li><strong>scales</strong>: scales allows to customize the plot. For instance in figure @ref(fig:fig1299) both x and y-axis used continuous data and hence the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> were used to modiy the values of the axis. For color, I simply stick on <code>scale_colour_discrete()</code> and customize the legend name.</li>
<li><strong>labels</strong>: The plot is well labelled and easy to understand. It has title, subtitle, axes and caption for the courtesy of the data.</li>
<li><strong>theme</strong>: the plot stick on the default <code>theme_gray</code> theme, which has a gray background color and white gridlines, a sans serif font family, and a base font size of 11. We can customize all the propoerties in the theme to suit our standard.</li>
</ul>
</section>
<section id="building-a-plot" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="building-a-plot"><span class="header-section-number">6.3</span> Building a plot</h2>
<p>Since you now have a clue of the different layers added to create a plot, its time to work around to create a plot with the <strong>ggplot2</strong> package. We use the same profile dataset that used to make figure @ref(fig:fig1299). First, you neeed to import the data into your R session.</p>
<section id="plotting-layers" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="plotting-layers"><span class="header-section-number">6.3.1</span> Plotting layers</h3>
<p>To create a data visualization using <strong>ggplot2</strong> package, we will add <code>layers</code> for each of the plot elements described in section @ref(components). I will take you through step by step of the key ines needed to make such a plot. First make sure the <strong>ggplot2</strong> or <strong>tidyverse</strong> packages are loaded in your R’s session. You can load the package with this code;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <strong>ggplot2</strong> create a <code>ggplot</code> object, and you initialize the object with the <code>ggplot()</code> function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot above is black with grey background. This is because we have not specified the data and aesthetic arguments inside the <code>ggplot()</code> function. Let’s specify the data, which in our case is the ctd dataset and also specify the x-axis with temperature and y-axis with fluorescence.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now the plot has gridlines and axis with values and labels—x-axis show the value of temperature and the y-axis show the value of fluorescence concentrations. However, there is no graphics. This is because we have not added any geom yet. Therefore, since we have already specified the data and the aesthetic values, now we can add the geom where we map the aesthetics to columns in the dataset. Let’s add the <code>geom_point()</code> and specify the size to 3</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence)) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size  =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="customize-legend" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="customize-legend"><span class="header-section-number">6.3.2</span> Customize legend</h3>
<p>The plot now show points distributed in the panel plot. But our interest is to color the point at each transect. Next, we add an argument <code>col</code> in the aesthetic that map points that fall along a certain transect with similar color. Since we have a variable called transect in the dataset, we specify this as the code below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The plot above show the points are color–coded to refrect the transect in the legend. Note that the colors scheme used in this plot is the default one. Sometimes you will want to customize the aesthetic for all the points in the plot. To change a color scale, you can use the <code>scale_color_viridis_d()</code>. The <code>_d</code> here represent the discrete variable. If you were using the continuous data, you would use <code>scale_color_viridis_c()</code> scheme instead.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To change the title of the legend you must specify the name argument in your <code>scale_*</code> function. For instance, we specified <code>scale_colour_viridis_d(name = "Transects")</code> to change the legend title for this plot</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects</span><span class="sc">\n</span><span class="st"> of CTD Casts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>If you want to remove the legend title, we can add a theme layer and specify <code>theme(legend.title = element_blank())</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>) <span class="sc">+</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also change the legend title by specifying theme(legend.title = element_blank())</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects</span><span class="sc">\n</span><span class="st">of CTD Casts"</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="st">"chocolate"</span>, <span class="at">face =</span> <span class="st">"bold"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="working-with-titles-and-labels" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="working-with-titles-and-labels"><span class="header-section-number">6.3.3</span> Working with titles and labels</h3>
<p>Often times you need to customize the axis labels. By default, the scale label for each scale is the name of the variable in the dataset. We can change the labels with <code>labs()</code> function. The other elements we would like to add are the plot title and subtitle. If you want to label SI unit in the ggplot, use the <code>expression()</code> function. Note that I used the <code>expression()</code> function to express mathematical symbols in the x and y–axis of the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="customize-glidline-and-axis-labels" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="customize-glidline-and-axis-labels"><span class="header-section-number">6.4</span> Customize glidline and axis labels</h2>
<p>The other layer that we would like to add to customize our plot are the <code>scale_x_continous()</code>, which change the gridline of the x-axis and the <code>scale_y_continuous()</code>, which change the gridlines of the y-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="remove-the-gray-box-of-points-on-legend" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="remove-the-gray-box-of-points-on-legend"><span class="header-section-number">6.4.1</span> Remove the gray box of points on legend</h3>
<p>The default ggplot always put a gray background of the scatterplot. You can remove it by adding a theme layer and specify the argument <code>legend.key = element_blank()</code> to get rid of them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modify-the-position-of-the-legend" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="modify-the-position-of-the-legend"><span class="header-section-number">6.5</span> Modify the position of the legend</h2>
<p>By default, ggplot2 place the legend on the right position. You can decided to place either left, right, top or bottom. For example, if we want to place the legend at the bottom, we simply specifying the argument <code>legend.position = "bottom"</code> in the theme layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can also position the legend insite the plot and specify the x and y coordinates. The coordinates range from 0 to 1, from left to right or bottom to top of the plot. For instance, we can place the legend at the top right corner of the plot by specifying <code>legend.position = c(.9,.75)</code> in the theme layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="change-the-legend-background-and-stroke-color" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="change-the-legend-background-and-stroke-color"><span class="header-section-number">6.5.1</span> Change the legend background and stroke color</h3>
<p>By default, ggplot legend has a white fill for background and without color for stroke. We can customize the look of the legend in the theme layer. For example, we want our legend to have an ivory fill and black stroke of 0.25 size. This can be achieved by adding and argument<code>legend.background = element_rect(fill = "ivory", colour = "black", size = .25)</code> in the theme layer.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"ivory"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> .<span class="dv">25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modify-background-colors" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="modify-background-colors"><span class="header-section-number">6.5.2</span> Modify background colors</h3>
<p>You can remove the background fill and stroke color with the <code>panel.background = element_blank()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"ivory"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> .<span class="dv">25</span>),</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can customize the the background fill and stroke colors to your what fit you best with the <code>panel.background = element_rect()</code> and specify the stroke with <code>color</code> and background with the <code>fill</code> arguments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"ivory"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> .<span class="dv">25</span>),</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"lightblue"</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="change-the-gridlines" class="level3" data-number="6.5.3">
<h3 data-number="6.5.3" class="anchored" data-anchor-id="change-the-gridlines"><span class="header-section-number">6.5.3</span> change the gridlines</h3>
<p>You can also customize the color and shape of the gridlines. You can remove the gridline with <code>panel.grid = element_blank()</code> argument in the theme layer. But if you want to customize the gridlines, then you use the <code>panel.grid = element_line()</code> and specify the <code>color</code> and <code>linetype</code> etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">75</span>),</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"ivory"</span>, <span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">size =</span> .<span class="dv">25</span>),</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey60"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size =</span> .<span class="dv">25</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="change-the-font-size-for-axis-labels-and-titles" class="level3" data-number="6.5.4">
<h3 data-number="6.5.4" class="anchored" data-anchor-id="change-the-font-size-for-axis-labels-and-titles"><span class="header-section-number">6.5.4</span> Change the font size for axis, labels and titles</h3>
<p>The fonts for axis ticks, axis-title text have a default font size of 11, if we want to increase the font size to 12 then then we can do that inside the <code>theme()</code>. We can also change the font size for titles, subtitles and legend text and title as the chunk below highlight.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="limit-axis-to-a-range" class="level3" data-number="6.5.5">
<h3 data-number="6.5.5" class="anchored" data-anchor-id="limit-axis-to-a-range"><span class="header-section-number">6.5.5</span> Limit axis to a range</h3>
<p>We use the <code>coord_cartesian()</code> function to adjust the visible area of the plot. You should specify the range of the <code>ylim=c()</code> and <code>xlim = c()</code> and <code>expand = FALSE</code> to show only the area of the plot you want to visualize.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="adding-labels" class="level3" data-number="6.5.6">
<h3 data-number="6.5.6" class="anchored" data-anchor-id="adding-labels"><span class="header-section-number">6.5.6</span> Adding labels</h3>
<p>ggplot2 provide <code>geom_tex()</code> and <code>geom_label</code> function for adding label on the plot. <code>geom_text()</code> adds text directly to the plot. <code>geom_label()</code> draws a rectangle behind the text, making it easier to read.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> station), <span class="at">nudge_x =</span> <span class="fl">0.05</span>, <span class="at">nudge_y =</span> .<span class="dv">04</span>)<span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I find it difficult to position label with <code>geom_text()</code>, especially when you have a lot of points to label. I often use the <strong>ggrepel</strong> package, which provides text and label geoms for <strong>ggplot2</strong> that help to avoid overlapping text labels. These function makes labels repel away from each other and away from the data points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> station))<span class="sc">+</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="add-text-annotation" class="level3" data-number="6.5.7">
<h3 data-number="6.5.7" class="anchored" data-anchor-id="add-text-annotation"><span class="header-section-number">6.5.7</span> Add text annotation</h3>
<p>There are times you may need to add a text on top of the plot. In <em>ggplot2</em> you can place a label using the real values on the plot instead of the hard-core coorinates to specify the location based on scaled coordinates where 0 is low and 1 is high. This is useful for adding small annotations (such as text labels) or if you have your data in vectors, and for some reason don’t want to put them in a data frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>), </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> transect)) <span class="sc">+</span> </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_viridis_d</span>(<span class="at">name =</span> <span class="st">"Transects"</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Association of Temperature and Profile"</span>,</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"The plot indicat a remarkable sign of transect dependency"</span>, </span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Courtesy of IIOE-2"</span>)<span class="sc">+</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">25</span>,<span class="dv">26</span>,<span class="fl">0.25</span>))<span class="sc">+</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.2</span>,<span class="fl">1.8</span>,.<span class="dv">2</span>))<span class="sc">+</span> </span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.key =</span> <span class="fu">element_blank</span>(), </span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.title =</span> <span class="fu">element_text</span>( <span class="at">size =</span> <span class="dv">20</span>), </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), </span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>), </span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>)) <span class="sc">+</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">24.9</span>,<span class="fl">26.05</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="dv">2</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">25.95</span> , <span class="at">y =</span> <span class="fl">1.82</span>, <span class="at">label =</span> <span class="st">"My label"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="make-the-x-and-y-axis-the-same" class="level3" data-number="6.5.8">
<h3 data-number="6.5.8" class="anchored" data-anchor-id="make-the-x-and-y-axis-the-same"><span class="header-section-number">6.5.8</span> Make the x and y axis the same</h3>
<p>The <code>coord_cartesian()</code> is the coordinate system that you will use most of the time because most of the plot are created from two or more variables that have different scales. However, there are situations where you create plots that use the same scale of x-and y-coordinates. For example, ploting temperature profiles from two stations, then an appropriate coordinae system in that case is the <code>coord_equal()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">## tidy the temperature from long to wide format </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>ctd.temprature.wide <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(station, temperature, pressure) <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> <span class="st">"station"</span>, <span class="at">value =</span> <span class="st">"temperature"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">## make aplot</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.temprature.wide, </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> st3, <span class="at">y =</span> st8)) <span class="sc">+</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_equal</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="faceting-creating-multipanel-plots" class="level3" data-number="6.5.9">
<h3 data-number="6.5.9" class="anchored" data-anchor-id="faceting-creating-multipanel-plots"><span class="header-section-number">6.5.9</span> Faceting —Creating multi–panel plots</h3>
<p>Facets are ways of arranging plots into multiple different pieces (subplots). This allows you to view a separate plot for each unique value in a categorical variable. The <strong>ggplot2</strong> package has a nice function for creating multi-panel plots. The <code>facet_wrap</code> creates essentially a ribbon of plots based on a single variable. For example the plot below, I first filtered only profile below 201 meters and classify them into bins of below 50 meters, 50 to 100 and above 100 meters. This computed depth class was used to make multiple plot of boxplot of fluorescence at the four transects. in the <code>facet_wrap()</code> layer, I specified the <code>~depth.class</code> to use this variable for faceting and <code>nrow = 1</code>, for the canvas to have one row with multiple columns depending on the groups, four our case we get three columns from the depth classes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## filter the pressure and break them into class of 50,100,200</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>ctd.class.depth <span class="ot">=</span> ctd <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pressure <span class="sc">&lt;</span> <span class="dv">201</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">depth.class =</span> <span class="fu">cut</span>(pressure, </span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), </span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Below 50"</span>, <span class="st">"50-100"</span>, <span class="st">"Above 100"</span>))) </span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ctd.class.depth, </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> transect,<span class="at">y =</span> fluorescence, <span class="at">fill =</span> transect)) <span class="sc">+</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"transect 1"</span>, <span class="st">"transect 2"</span>, <span class="st">"transect 3"</span>, <span class="st">"transect 4"</span>), </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pemba"</span>, <span class="st">"Kimbiji"</span>, <span class="st">"Lindi"</span>, <span class="st">"Mtwara"</span>)) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})))<span class="sc">+</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>depth.class, <span class="at">nrow =</span> <span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faceted" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-faceted-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure 6.2: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="allow-scales-to-roam-free-scales" class="level3" data-number="6.5.10">
<h3 data-number="6.5.10" class="anchored" data-anchor-id="allow-scales-to-roam-free-scales"><span class="header-section-number">6.5.10</span> Allow scales to roam free (scales)</h3>
<p>The default for multi-panel plots in <strong>ggplot2</strong> is to use equivalent scales in each panel. But sometimes you want to allow a panel’s own data to determine the scale. This may mislead to the audience since it give creaes plots with different scales. You can specify the <code>scales="free"</code> in the <code>facet_wrap()</code> layer written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">## filter the pressure and break them into class of 50,100,200</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ctd.class.depth <span class="ot">=</span> ctd <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pressure <span class="sc">&lt;</span> <span class="dv">201</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">depth.class =</span> <span class="fu">cut</span>(pressure, </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>), </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Below 50"</span>, <span class="st">"50-100"</span>, <span class="st">"Above 100"</span>))) </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span> ctd.class.depth, </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> transect,<span class="at">y =</span> fluorescence, <span class="at">fill =</span> transect)) <span class="sc">+</span> </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span> </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"transect 1"</span>, <span class="st">"transect 2"</span>, <span class="st">"transect 3"</span>, <span class="st">"transect 4"</span>), </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Pemba"</span>, <span class="st">"Kimbiji"</span>, <span class="st">"Lindi"</span>, <span class="st">"Mtwara"</span>)) <span class="sc">+</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="fu">expression</span>(Fluorescence<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})))<span class="sc">+</span> </span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>depth.class, <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-faceted1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-faceted1-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure 6.3: <strong>?(caption)</strong></figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="basic-plots" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="basic-plots"><span class="header-section-number">6.6</span> Basic plots</h2>
<p>The <strong>ggplot2</strong> package provides a set of functions that mirror the <em>Grammar of Graphics</em>, enabling you to efficaciously specify what you want a plot to look like. To have a glimpse of <strong>ggplot2</strong>, we start with five basic types of plots that are familiar to most people. These include:</p>
<ol type="1">
<li>scatterplot</li>
<li>linegraphs</li>
<li>boxplots</li>
<li>histograms</li>
<li>barplots</li>
</ol>
<blockquote class="blockquote">
<p>Note that the four graphs works with quantitative data and barplots are appropriate for categorical data. Thus, understanding the type of data you want to plot is a fundamental principle before you throw the variable into <strong>ggplot2</strong> to make plot for you.</p>
</blockquote>
<section id="scatterplot" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="scatterplot"><span class="header-section-number">6.6.1</span> scatterplot</h3>
<p>Scatterplots are also called bivariate, allows you to visualize the association between two numerical variables. They are among the widely used plot because they can provide an immediate way to see the pattern of association between two numerical variables.</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plotting_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">scatterplot from base R</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Most of us are familiar with scatterplot shown in figure &nbsp;and made several of them using base R, but probably you have not made one based on the fundamental theorem of <em>grammar of graphics</em>. We will visualize the relationship between temperature and fluorescence. Because the ctd is profile data frame with variable as function of pressure, we want to check for the association of all the 22 station but at fixed depth of 10 meters. What this means is that we will take the ctd data and filter all variable at all station measured at water depth of 10 meters from the surface and save this in a new data frame called ctd10d. This can be written as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>ctd10d <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s now dive into the code of using the *grammar of graphics<strong> to create the scatterplot. We use the <code>ggplot()</code> function from </strong>ggplot2** package. The code to create figure @ref(fig:) is written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd10d,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence)) <span class="sc">+</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s explore the block above piece-by-piece</p>
<ul>
<li>The plotting in <strong>ggplot2</strong> begin with <code>ggplot()</code> function, where the two components of <em>grammar of graphics</em> are required. in the <code>data</code> component we specify the data frame of variables measured at 10 meter water below the surface by setting <code>data = ctd10d</code>. Then the second argument <code>aes</code>thetic that map the plot with coordinate was set by <code>aes(x = temperature, y = fluorescence))</code>. In a nutshell, the <code>aes()</code> define the variable–axis specifications. For the code above we set the variables <code>temperature</code> into the <code>x</code> coordinate and the variable <code>fluorescence</code> into the <code>y-axis</code>.</li>
<li>We then add a layer to the <code>ggplot()</code> function calll using the <code>+</code> sign. The added layer specify the third part of the *grammar—the <code>geom</code>etric component. Becasue we want to plot scatterplot, the appropriate <code>geom</code> for this case is the <code>geom_point()</code>.</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plotting_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Once the code is run, it produce two outputs: a warning message and figure @ref(fig:). The warning message notify us that out of the 22 stations, there are three stations with missing data at 10 meter water. We can check station with missing values with code written below;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>ctd10d <span class="sc">%&gt;%</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(temperature)) <span class="sc">%&gt;%</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(station, pressure, temperature, fluorescence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 x 4
  station pressure temperature fluorescence
  &lt;chr&gt;      &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;
1 st10          10          NA           NA
2 st4           10          NA           NA
3 st5           10          NA           NA</code></pre>
</div>
</div>
</section>
<section id="adding-regression-line" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="adding-regression-line"><span class="header-section-number">6.6.2</span> adding regression line</h3>
<p>you can simply add the regression line by addign a <code>geom_smooth()</code> layer and specify the <code>method = "lm"</code> and we dont need to show the confidence errors, hence we specify <code>se = FALSE</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd10d,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence)) <span class="sc">+</span> </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()  <span class="sc">+</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>While the geom_point() and geom_smooth() layers in this code both use the same aesthetic mappings, there’s no reason you couldn’t assign different aesthetic mappings to each geometry. Note that if the layers do share some aesthetic mappings, you can specify those as an argument to the ggplot() function</p>
<p>Looking on the generated scatterplot (Figure @ref(fig:)), we notice a negative relation exist between temperature and fluorescence—stations with high temperature have relatively low concentration of fluorescence and viceversa. We also notice that 16 stations are clustered within <span class="math inline">\(25-25.25^{\circ}\)</span> C and only three are found at temperature range between <span class="math inline">\(25.75-26^{\circ}\)</span> C. We can identify these pattern by adding a <code>col</code> argument in <code>aes</code> by setting <code>aes(x = temperature, y = fluorescence, col = Lat.label))</code>. The code for creating figure @ref(fig:) is written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd10d,</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">col =</span> Lat.label)) <span class="sc">+</span> </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Looking on the color of thelegend, it clearly indicate the two stations with temperatur above <span class="math inline">\(25.75^{\circ}\)</span> C are found along the transect lies along latitude 5.49°S in Pemba Channel and and one at latitde7.04°S off the Kimbiji.</p>
<p>We may also be interested to knwo whether dissolved oxygen has influrence on the the association of temperature and fluoresce. We can achieve that by simply parsing the the <code>shape = oxygen</code>, arguments into the <code>aes</code>thetic component. Figure @ref(fig:) clearly shows the stations with relatively high chlorophyll value have bigger shape (high DO value) and found in relatively less warmer waters in contrast to stations with low chl-value have smaller shape size, indicating low DO and found in relatively warmer water. The chunk for making figure @ref(fig:) is written as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd10d,</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> fluorescence, <span class="at">size =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 3 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plotting_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Scatterplot showing the association between temperature and fluorescence at 10 meter water from the surface and the influence of dissolved oxygen</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="linegraph" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="linegraph"><span class="header-section-number">6.7</span> Linegraph</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># I donwloaded the data using the code below and save it into the project directory. This chunk will never run but rather the proceeding step will use the data that was downloade and processed with code in this chunk.</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> xtractomatic<span class="sc">::</span><span class="fu">searchData</span>(<span class="st">"datasetname:mday"</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  sst, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>xtractomatic<span class="sc">::</span><span class="fu">getInfo</span>(<span class="at">dtype =</span> <span class="st">"mhsstdmday"</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  Chlorophyll-a, Aqua MODIS, NPP, L3SMI, Global,0.041, Science Quality (Monthly Composite)</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>xtractomatic<span class="sc">::</span><span class="fu">getInfo</span>(<span class="at">dtype =</span> <span class="st">"mhchlamday"</span>)</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>sst <span class="ot">=</span> xtractomatic<span class="sc">::</span><span class="fu">xtracto_3D</span>(<span class="at">dtype =</span> <span class="st">"mhsstdmday"</span>, </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">xpos =</span> <span class="fu">c</span>(<span class="fl">38.79272</span>,<span class="fl">40.24292</span>), </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ypos =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.692232</span>,<span class="sc">-</span><span class="fl">5.451759</span>), </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">tpos =</span> <span class="fu">c</span>(<span class="st">"2014-11-02"</span>, <span class="st">"2019-04-16"</span>))</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>chl <span class="ot">=</span> xtractomatic<span class="sc">::</span><span class="fu">xtracto_3D</span>(<span class="at">dtype =</span> <span class="st">"mhchlamday"</span>, </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">xpos =</span> <span class="fu">c</span>(<span class="fl">38.79272</span>, <span class="fl">40.24292</span>), </span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">ypos =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.692232</span>, <span class="sc">-</span><span class="fl">5.451759</span>), </span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">tpos =</span> <span class="fu">c</span>(<span class="st">"2003-01-17"</span>, <span class="st">"2019-04-16"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The next basic graph of ggplot2 is the linegraph. Linegraphs is similar to drawing points, except that it conncets the points with line. often times you dont show the points. Linegraphs are commonly used to show time series data. Its inappropriate to use the linegraphs for data that has no clear sequential ordering . Let’s illustrate how to create linegraphs using another dataset of<code>chlorophyll</code> concentration in the Pemba channel. This is a monthly average data from MODIS satellite. I processed the data and stored them in <code>.RData</code> format. We can load this dataset from the working directory with the <code>load()</code> function as shown in the chunk below;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"assets/modis_pemba.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Exploring further the dataset, we notice that its an array with 35 longitude spacing and 7 latitude spacing and 196 matrix collected every month from 2003-01-16 to 2019-04-16. Being an array, this dataset is not in the right format, since <strong>ggplot2</strong> only accept the data frame format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>chl<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">class</span>();chl<span class="sc">$</span>data <span class="sc">%&gt;%</span> <span class="fu">dim</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "array"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  35   7 196</code></pre>
</div>
</div>
<p>Therefore, we need to tidy this dataset from the array into the data frame and find average chlorophyll concentration for each month for 196 months. Because there are 196 matrix, that is a lot of work to do it one after the other. The easiest solution is to loop the process with a <code>for</code> loop. If you are not familiar with how loop works in R, I suggest you check section__ of chapter__, which describe in details. The chunk below highlight the <code>for</code> loop used to convert an array to matrix</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## preallocate object</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sst.tb <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>chl.tb <span class="ot">=</span> <span class="fu">list</span>()</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">## loop sst</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sst<span class="sc">$</span>time)){</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  sst.tb[[i]] <span class="ot">=</span> <span class="fu">matrix_tb</span>(<span class="at">x =</span> sst<span class="sc">$</span>longitude, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> sst<span class="sc">$</span>latitude, </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> sst<span class="sc">$</span>data[,,i]) <span class="sc">%&gt;%</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> sst<span class="sc">$</span>time[i] <span class="sc">%&gt;%</span><span class="fu">as.Date</span>()) <span class="sc">%&gt;%</span>  </span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">date =</span> time,<span class="at">lon =</span> x, <span class="at">lat =</span> y, <span class="at">sst =</span> value) </span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="do">## loop chl</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(chl<span class="sc">$</span>time)){</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  chl.tb[[j]] <span class="ot">=</span> <span class="fu">matrix_tb</span>(<span class="at">x =</span> chl<span class="sc">$</span>longitude, </span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> chl<span class="sc">$</span>latitude, </span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> chl<span class="sc">$</span>data[,,j]) <span class="sc">%&gt;%</span> </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> chl<span class="sc">$</span>time[j] <span class="sc">%&gt;%</span><span class="fu">as.Date</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">date =</span> time,<span class="at">lon =</span> x, <span class="at">lat =</span> y, <span class="at">chl =</span> value) </span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="do">## unlist the listed sst and chl files</span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>sst.tb <span class="ot">=</span> sst.tb <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(sst.tb)</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>chl.tb <span class="ot">=</span> chl.tb <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(chl.tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then used the function in <code>lubridate::year()</code> and <code>lubridate::month()</code> to create the <code>year</code> and <code>month</code> variables from the <code>date</code> variables</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>chl.decompose <span class="ot">=</span> chl.tb <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">abb =</span> <span class="cn">TRUE</span>), </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date) <span class="sc">%&gt;%</span> <span class="fu">as.integer</span>()) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To make a plot of annual average of chlorophyll concentration in the Pemba Channel, we need to monthly mean. We exclude data for year 2003 and 2019 because there only seven months in 2003 and four months in 2019, which can affect the analysis. computing annual average can be written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>chl.yearly <span class="ot">=</span> chl.decompose <span class="sc">%&gt;%</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">&gt;=</span> <span class="dv">2003</span> <span class="sc">&amp;</span> year <span class="sc">&lt;=</span> <span class="dv">2018</span>)<span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">chl =</span> <span class="fu">mean</span>(chl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s create linegraph of annual average chlorophyll-a concentration in the Pemba Channel. Like the scatterplot we made earlier, where supply the data frame in <code>data</code> argument and specified the <code>aes</code>thetic mapping with <code>x</code> and <code>y</code> cooridnates, but instead of using <code>geom_point()</code>, we use the <code>geom_line()</code>. The code to make the line graphy of annual average chlorophyll-a conceration shown in figure @ref(fig:) are written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.yearly, </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since the selected area is affected with monsoon season, we can further decode the months into their respective southeast (SE) and northeast (NE) and inter-monsoon (IN) seasons using the <code>decode()</code> function from <strong>dplyr</strong> package as the chunk below show;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>chl.season <span class="ot">=</span> chl.decompose <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> month <span class="sc">%&gt;%</span> <span class="fu">as.character</span>(), </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Jan =</span> <span class="st">"NE"</span>),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Feb =</span> <span class="st">"NE"</span>),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Mar =</span> <span class="st">"NE"</span>),</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Apr =</span> <span class="st">"IN"</span>),</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">May =</span> <span class="st">"SE"</span>),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Jun =</span> <span class="st">"SE"</span>),</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Jul =</span> <span class="st">"SE"</span>),</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Aug =</span> <span class="st">"SE"</span>),</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Sep =</span> <span class="st">"SE"</span>),</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Oct =</span> <span class="st">"IN"</span>),</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Nov =</span> <span class="st">"NE"</span>),</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">season =</span> <span class="fu">recode</span>(<span class="at">.x =</span> season, <span class="at">Dec =</span> <span class="st">"NE"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We then compute the year average of chlorophyll-a at each season as written in the chunk below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>chl.season <span class="ot">=</span> chl.season <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>( year <span class="sc">&gt;=</span> <span class="dv">2003</span> <span class="sc">&amp;</span> year <span class="sc">&lt;</span> <span class="dv">2019</span>)<span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year,season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">chl =</span> <span class="fu">mean</span>(chl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>To make a linegraphy that show annual average of chlorophyll-a concetration for each season as in figure @ref(fig:), we simply parse the argument <code>col == season</code> in the <code>aes()</code> component as the chunk below hightlight</p>
<div class="cell" data-aval="false">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.season, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> chl, <span class="at">col =</span> season))<span class="sc">+</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2002</span>,<span class="dv">2019</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="histogram" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="histogram"><span class="header-section-number">6.7.1</span> histogram</h3>
<p>A histogram is a plot that can be used to examine the shape and spread of continuous data. It looks very similar to a bar graph and organized in intervals or classes. . It divides the range of the data into <code>bin</code> equal intervals (also called bins or classes), count the number of observations n in each bin, and display the frequency distribution of observations as a bar plot. Such histogram plots provide valuable information on the characteristics of the data, such as the <code>central tendency</code>, the <code>dispersion</code> and the general <code>shape</code> of the distribution.</p>
<p>Let’s consider the <code>chl</code> variable in the <code>chl.tb</code> data frame. Since histogram works for single variable that contains quantitative values, you can not bother looking for relationship as we have seen in previous plots, but histogram offers an opportunity to answer question like</p>
<ol type="1">
<li>What are the smallest and largest values of chl-a?</li>
<li>What is the center value? 3 How does these values spread out?</li>
</ol>
<p>We can make a histogram shown in figure @ref(fig:) by simply setting <code>aes(x = chl)</code> and add <code>geom_histogram()</code>. Within the geom_histogram(), we simply specify the number of bins <code>bins = 28</code> and also the color seprating each column of the histogram with <code>col == "white"</code>. The code to create figure @ref(fig:), which displays a histogram with twenty eight classes, is written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.decompose <span class="sc">%&gt;%</span> <span class="fu">filter</span>(chl <span class="sc">&lt;</span> .<span class="dv">5</span>), </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> chl))<span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">28</span>, <span class="at">col =</span> <span class="st">"white"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="plotting_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Histogram showing the distribution of chlorophyll concentration</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="boxplot" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="boxplot"><span class="header-section-number">6.7.2</span> boxplot</h3>
<p>The box plot is a standardized way of displaying the distribution of data based on the five number summary: minimum, first quartile, median, third quartile, and maximum. Box plots are useful for detecting outliers and for comparing distributions. These five number summary also called the 25<sup>th</sup> percentile, median, and 75<sup>th</sup> percentile of the quantitative data. The whisker (vertical lines) capture reoungly 99% of a distribution, and observaion outside this range are plottted as points representing outliers.</p>
<p>Box plots can be created by using the <code>geom_boxplot()</code> function and specify the data variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.decompose <span class="sc">%&gt;%</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>( chl <span class="sc">&lt;</span>  .<span class="dv">25</span>), <span class="fu">aes</span>(<span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The firstinput must be a categorical variable and the second must be a continuous variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.season <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>( chl <span class="sc">&lt;</span>  .<span class="dv">25</span>), <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>the <code>geom_boxplot()</code> has <code>outlier_</code> arguments that allows to highlight and modify the color, shape, size, alpha … etc of outliers —extreme observation. For instance, you can highlight the outlier with;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.season <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>( chl <span class="sc">&lt;</span>  .<span class="dv">25</span>), <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<p>We can also map the fill and color to variable in to distinguish boxplot. for example, we can specify the <code>fill = season</code> argument in the <code>aes()</code> to fill the boxplot based on season.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sst.season , </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">y =</span> sst, <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"black"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span><span class="fl">1.2</span>)<span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can add the points on top of the boxplot with the <code>geom_jitter()</code>. It also allows for specifying other arguments like colors and width of the points.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> chl.season <span class="sc">%&gt;%</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">filter</span>( chl <span class="sc">&lt;</span>  .<span class="dv">25</span>), <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> .<span class="dv">05</span>, <span class="at">height =</span> .<span class="dv">05</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="barplot" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="barplot"><span class="header-section-number">6.7.3</span> barplot</h3>
<p>Bar graphs are perhaps the widely used plot. They are typically used to display numeric values on the y-axis for different groups on the x-axis. There is an important distiction you should be aware of when making bar graphs. The heigh of a bar in barplot may represent either the counts or values of elements in the dataset. Let’s begin with the former—count. We use the drifter observations, which passed at the confluence—where the South Equatorial Current splits to form the northward flowing called the East Africa Coastal Current and the southward flowing the Mozambique Current. We first load the daset as the code highlight;</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>drifter_confluence <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"assets//drifter_confluence.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="barplot-for-count" class="level4" data-number="6.7.3.1">
<h4 data-number="6.7.3.1" class="anchored" data-anchor-id="barplot-for-count"><span class="header-section-number">6.7.3.1</span> barplot for count</h4>
<p>To make the bar graph that show the number of drifters crossed the ares per month over the entire period you you simply specify the the variable <code>month</code> in the <code>x</code> coordinates in the <code>aes</code>thetic and add the <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>drifter_confluence <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month)) <span class="sc">+</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sometimes you may wish to stack bars. For instance drifter have drogued—an anchor, which reduce speed of the drifter wind effect. When the drogue is lost, drifter slip and tend to overestimate the current speed. In our dataset, the drogue are coded with <code>0 == Absent</code>, and <code>1 = Present</code>. Because zero and ones make no sense, we create a new variables of that replace zero with <code>LOST</code> and ones with <code>PRESENT.</code> we use the <code>if_else()</code> function from <strong>dplyr</strong> to convert these values and assign the object as <code>drifter.drogue</code>. The conversion can be attained with code written as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>drifter.drouge <span class="ot">=</span> drifter_confluence <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">drogue.status =</span> <span class="fu">if_else</span>(<span class="at">condition =</span> drogue<span class="sc">==</span><span class="dv">1</span>, <span class="at">true =</span> <span class="st">"PRESENT"</span>, <span class="at">false =</span> <span class="st">"LOST"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then to stack the bar based on the drogue status, we simpy add the <code>fill = drogue.status</code> in <code>aes()</code> part</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.drouge, </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>You can flip the order of bar with <code>position = position_stack(reverse = TRUE)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.drouge, </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Instead of stacking, you can dodge the bar with <code>position = position_dodge()</code> argument</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.drouge, </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>To add a black stroke color of the bar, add the argument <code>col = "black"</code> inside the <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.drouge, </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">col =</span> <span class="st">"black"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And to specify the width of the bar you specify a value in <code>width</code> argument in <code>geom_bar()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.drouge, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">width =</span> .<span class="dv">75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sometimes you want to map bar with different colors for negative and positive values. For this case we will use the sea surface temperature from drifter observation and create a new variable called anomaly—indicate the temperature value above (positive value) and below (negative) the climatological mean. The code for computing anomaly is;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>sst.anomaly <span class="ot">=</span> drifter_confluence <span class="sc">%&gt;%</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span> </span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">average =</span> <span class="fu">mean</span>(sst, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">anomaly =</span> average <span class="sc">-</span> <span class="fu">mean</span>(average), </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">anomaly.status =</span> <span class="fu">if_else</span>(anomaly <span class="sc">&gt;</span> <span class="dv">0</span> , <span class="st">"Above"</span>, <span class="st">"Below"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">1996</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>once we have computed the anomaly of sea surface temperature for each year, we can plot the withe <code>geom_col()</code> and specify <code>x = year</code>, and <code>y = anomaly</code> and <code>fill = anomaly.status</code>. We also need to specify the <code>position == "identity"</code> to prevent notification message of poor defined stacking for bar with negative values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span>sst.anomaly,</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> anomaly, <span class="at">fill =</span> anomaly.status)) <span class="sc">+</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">width =</span> .<span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although the plot looks good but sometimes we may wish to reverse the filled color.We can reorder the color with the <code>scale</code> layer. Because the variable used to fill the bar is categorical, the appropriate scale is <code>scale_fill_discrete()</code> and you specify the limits with <code>limits =  c("Below", "Above")</code>. The legend is this plot is not important and we can remove from th plot with <code>guides(fill = FALSE)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data =</span>sst.anomaly,</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> anomaly, <span class="at">fill =</span> anomaly.status)) <span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"identity"</span>, <span class="at">width =</span> .<span class="dv">8</span>)<span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Below"</span>, <span class="st">"Above"</span>))<span class="sc">+</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `guides(&lt;scale&gt; = FALSE)` is deprecated. Please use `guides(&lt;scale&gt; =
"none")` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The red</p>
</section>
</section>
<section id="barplot-for-values" class="level3" data-number="6.7.4">
<h3 data-number="6.7.4" class="anchored" data-anchor-id="barplot-for-values"><span class="header-section-number">6.7.4</span> barplot for values</h3>
<p>We have seen how to make barplot that show the count with <code>geom_bar()</code>. You can also use the barplot to show the values with the <code>geom_col()</code> function and specify what variables you want on the <code>x</code> and <code>y</code> axis. For instance, we want to show how surface current varies over twelve months. Because the <code>geom_col()</code> requires summarized statistics, we need to compute the average current speed for each month. The chunk below highlight how to compute the mean, maximum, minimum and standard deviation of surface current velocity for each month.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>current.speed.monthly <span class="ot">=</span> drifter.drouge <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>() <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">speed =</span> <span class="fu">sqrt</span>(u<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> v<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(month, drogue.status) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">speed_min =</span> <span class="fu">min</span>(speed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">speed_mean =</span> <span class="fu">mean</span>(speed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">speed_max =</span> <span class="fu">max</span>(speed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">speed_sd =</span> <span class="fu">sd</span>(speed, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'month'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Once we have computed the statistics, we can use them to make barplot. Note that unlike the <code>geom_bar()</code> that need only the <code>x</code> variable, <code>geom_col()</code> requires <code>x</code> and <code>y</code> variables specified. For illustration, we specified the <code>x = month</code>, and <code>y = speed_mean</code> in the <code>aes()</code> to make a barplot that show the monthly monthly mean surface current.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> current.speed.monthly, </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month,<span class="at">y =</span> speed_mean))<span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although ggplot2 allows to stack the barplot that present values, although they seems appealing, you must avoid making such kind of plot, because they tend to mislead and difficult to distinguish betwen the groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> current.speed.monthly, </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month,<span class="at">y =</span> speed_max, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The appropriate way if you want to compare two or more groups with <code>geom_col()</code>, you better doge the bar instead of stacking them. This makes easier to compare. For instance, in the case here, its cleary to see months of which drifter with lost drogues move relatively faster than those with droguue.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> current.speed.monthly, </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> month,<span class="at">y =</span> speed_max, <span class="at">fill =</span> drogue.status))<span class="sc">+</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note: the basic barplot that present count or frequency has one categorical variable on the x axis and you can make with <code>geom_bar()</code>And the barplot that present the values for instance the average of the variable has one categorical variable on the <code>x</code> axis and continuos variable on the <code>y</code> axis and you create them with <code>geom_col()</code> function. You can make a grouped bar plot by mapping that variable to <code>fill</code>, which represent the fill color of the bars. Like the variables mapped to the x axis, variables that are specified to the fill color of bars must be categorical instead of continuous.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>drifter.interest <span class="ot">=</span> drifter_confluence <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>(), <span class="at">begin =</span> dplyr<span class="sc">::</span><span class="fu">first</span>(date), <span class="at">end =</span> dplyr<span class="sc">::</span><span class="fu">last</span>(date), <span class="at">period =</span> lubridate<span class="sc">::</span><span class="fu">interval</span>(<span class="at">start =</span> begin, <span class="at">end =</span> end, <span class="at">tzone =</span> <span class="st">""</span>) <span class="sc">%&gt;%</span> lubridate<span class="sc">::</span><span class="fu">as.duration</span>() <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>(<span class="st">"hours"</span>)) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(period <span class="sc">&gt;</span><span class="dv">1000</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>drifter.interest.point <span class="ot">=</span> drifter.interest <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(drifter_confluence, <span class="at">by =</span> <span class="st">"id"</span>) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">id.drifter =</span> <span class="fu">paste</span>(<span class="st">"ids"</span>, id, <span class="at">sep =</span> <span class="st">""</span>))</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> drifter.interest.point , <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">col =</span> id.drifter))<span class="sc">+</span><span class="fu">geom_path</span>()<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">scale_x_longitude</span>(<span class="at">ticks =</span> .<span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">scale_y_latitude</span>(<span class="at">ticks =</span> .<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="advanced-plots" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="advanced-plots"><span class="header-section-number">6.8</span> Advanced plots</h2>
<p><strong>ggplot2</strong> with its add-in packages provides extensive capabilities for visualizing your data. You can produce 2D plots, 3D plots, and animations; you can view images; and you can create histograms, contour and surfaces plots, and other graphical representations of your data.</p>
<p>its’s fun to explore pattern over time with linegraphy. Time is so embedded in our day–to–day life tha so many aspects of visualizing temporal data are fairly intuitive. You understand thing changing and evolving—the hard part is figuring out by how much is changing and look for that change in the graph. It’s easy to glance over some lines on a plot and say something is increasing, which is good as that is the core function of visualization to help you see the patterns. But, because of averaging, we sometimes miss some subtle changes that hidden when we lumped data together.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>chl.tb <span class="sc">%&gt;%</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date), <span class="at">year =</span> lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(year, month) <span class="sc">%&gt;%</span> </span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">chl =</span> <span class="fu">mean</span>(chl, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))<span class="sc">%&gt;%</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">2019</span>) <span class="sc">%$%</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">interpolate2</span>(<span class="at">x =</span> year , <span class="at">y =</span> month, <span class="at">z =</span> chl, <span class="at">n =</span> <span class="dv">16</span>)<span class="sc">%&gt;%</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">year =</span> x, <span class="at">month =</span> y, <span class="at">chl =</span> z) <span class="sc">%&gt;%</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(chl <span class="sc">&lt;</span> .<span class="dv">4</span>)<span class="sc">%&gt;%</span> </span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span>year, <span class="at">y =</span> month, <span class="at">z =</span> chl))<span class="sc">+</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oce.colorsJet</span>(<span class="at">n =</span> <span class="dv">120</span>))<span class="sc">+</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">label =</span> <span class="fu">seq</span>(lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>                              lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">311219</span>), <span class="at">by =</span> <span class="st">"month"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>                    lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="at">abbr =</span> <span class="cn">TRUE</span>, <span class="at">label =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2002</span>,<span class="dv">2017</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">%+%</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">raster =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title =</span> <span class="fu">expression</span>(Chlorophyll<span class="sc">~</span>concetration<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'year'. You can override using the
`.groups` argument.
Loading required package: metR
Attaching package: 'metR'
The following object is masked from 'package:purrr':

cross</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>I used <code>oce::oce.colorsJet(120)</code> and specify 120 color gradient to obtain color scheme similar to the Matlab Jet scheme. It widely used for maps but works great for general visualization like heatmaps.</p>
<section id="facets" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="facets"><span class="header-section-number">6.8.1</span> Facets</h3>
<p>Sometimes you may wish to split your plot into facets—subplots that each display one subset of the data. Faceting is used when you wish make subplots from categorical variables. It creates multiple copies of the same type of plot with matching x and y axes. There is a <code>scale()</code>, which allows you to adjust the x and y axes according to groups in the categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="do">## list files from the working directory</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>tafiri <span class="ot">=</span> <span class="fu">list.files</span>(<span class="at">path =</span> <span class="st">"assets//"</span>,<span class="at">pattern =</span> <span class="st">"tafiri_"</span>, <span class="at">full.names =</span> <span class="cn">TRUE</span>, <span class="at">recursive =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="do">## make a vector of variables. The order must be consistency with the files order in </span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>var <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"chl"</span>, <span class="st">"pp"</span>, <span class="st">"sst"</span>)</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="do">## make a vector of site. The order must be consistency with the sheets in files</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>sites <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Pemba"</span>, <span class="st">"Zanzibar"</span>, <span class="st">"Mafia"</span>, <span class="st">"EEZ"</span>)</span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="do">## preallocate an empty object</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a>tafiri.data <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(var)){</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sites)){</span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">=</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="at">path =</span> tafiri[i], <span class="at">sheet =</span> j)<span class="sc">%&gt;%</span> </span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">date =</span> <span class="dv">1</span>, <span class="at">year =</span> <span class="dv">2</span>, <span class="at">value =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date), </span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>         <span class="at">day =</span> <span class="dv">15</span>,</span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">site =</span> sites[j], </span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>         <span class="at">variable =</span> var[i],</span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">date =</span> lubridate<span class="sc">::</span><span class="fu">make_date</span>(<span class="at">year =</span> year, <span class="at">month =</span> month, <span class="at">day =</span> day)) <span class="sc">%&gt;%</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(date)</span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a><span class="do">## stitch processed data frame from each sheet    </span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a>tafiri.data <span class="ot">=</span> tafiri.data <span class="sc">%&gt;%</span> </span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(data)</span>
<span id="cb83-28"><a href="#cb83-28" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb83-29"><a href="#cb83-29" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb83-30"><a href="#cb83-30" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For instance, suppose we’re interested in looking at how the hovmoller of monthly primary productivity varies over time across the four stations, We split this heatmaps by the four stations. We achieve this by simply adding <code>facet_wrap(~site, nrow = 2)</code> layer;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> tafiri.data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"pp"</span>),</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> month, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"February"</span>, <span class="st">"April"</span>, <span class="st">"June"</span>, <span class="st">"August"</span>, <span class="st">"October"</span>))<span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> oce<span class="sc">::</span><span class="fu">oce.colors9A</span>(<span class="dv">120</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="fu">expression</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}),</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">reverse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barwidth =</span> <span class="fu">unit</span>(.<span class="dv">4</span>, <span class="st">"cm"</span>),</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">raster =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title =</span> <span class="fu">expression</span>(Primary<span class="sc">~</span>Productivity<span class="sc">~</span>(Cm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}<span class="sc">~</span>yr<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}))))<span class="sc">+</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note the use of the tilde <code>~</code> before the <code>site</code> in <code>facet_wrap()</code>. The tilde is required when you want specify the variable that will be used to split the plots into subplots. We can add other arguments in the <code>facet_wrap()</code> function. Let say we want our plot to be in one rows and four columns by simply adding the argument <code>nrow = 1</code></p>
</section>
<section id="sea-surface-temperature" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="sea-surface-temperature"><span class="header-section-number">6.8.2</span> Sea Surface Temperature</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> tafiri.data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"sst"</span>),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> month, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2</span>,<span class="dv">11</span>,<span class="dv">2</span>), <span class="at">label =</span> <span class="fu">c</span>(<span class="st">"February"</span>, <span class="st">"April"</span>, <span class="st">"June"</span>, <span class="st">"August"</span>, <span class="st">"October"</span>))<span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> oce<span class="sc">::</span><span class="fu">oce.colors9A</span>(<span class="dv">120</span>))<span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="dv">1</span>), <span class="at">axis.title =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="fu">expression</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}),</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">reverse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barwidth =</span> <span class="fu">unit</span>(.<span class="dv">4</span>, <span class="st">"cm"</span>),</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">raster =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">10</span>, <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title =</span> <span class="fu">expression</span>(Sea<span class="sc">~</span>Surface<span class="sc">~</span>Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C))))<span class="sc">+</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>site, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="subplot" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="subplot"><span class="header-section-number">6.8.3</span> Subplot</h3>
<p>There are occasions when it is convenient to display several plots side-by-side. In these instances, you will want to use the <strong>cowplot</strong> package. we first create <strong>ggplot2</strong> object of Primary productivity for the channels we are interested: for Mafia Channel we assign the name <code>mafia.pp</code> and for Zanzibar Channel <code>zanzibar.pp</code>. The chunk below show how to create the these object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mafia.pp <span class="ot">=</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> tafiri.data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"pp"</span> <span class="sc">&amp;</span> site <span class="sc">==</span> <span class="st">"Mafia"</span>),</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> month, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">label =</span> <span class="fu">seq</span>(lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                                            lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">311219</span>), <span class="at">by =</span> <span class="st">"month"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>                    lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="at">abbr =</span> <span class="cn">TRUE</span>, <span class="at">label =</span> <span class="cn">TRUE</span>))<span class="sc">+</span> </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> oce<span class="sc">::</span><span class="fu">oce.colors9A</span>(<span class="dv">120</span>),<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>), <span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="fu">expression</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}),</span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">reverse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barwidth =</span> <span class="fu">unit</span>(.<span class="dv">4</span>, <span class="st">"cm"</span>),</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">raster =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title =</span> <span class="fu">expression</span>(Primary<span class="sc">~</span>Productivity<span class="sc">~</span>(Cm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}<span class="sc">~</span>yr<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}))))</span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a>zanzibar.pp <span class="ot">=</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> tafiri.data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"pp"</span> <span class="sc">&amp;</span> site <span class="sc">==</span> <span class="st">"Zanzibar"</span>),</span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> month, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>, <span class="at">label =</span> <span class="fu">seq</span>(lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">010119</span>), </span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>                                            lubridate<span class="sc">::</span><span class="fu">dmy</span>(<span class="dv">311219</span>), <span class="at">by =</span> <span class="st">"month"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>                    lubridate<span class="sc">::</span><span class="fu">month</span>(<span class="at">abbr =</span> <span class="cn">TRUE</span>, <span class="at">label =</span> <span class="cn">TRUE</span>))<span class="sc">+</span>  </span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">2004</span>,<span class="dv">2017</span>,<span class="dv">4</span>))<span class="sc">+</span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colors =</span> oce<span class="sc">::</span><span class="fu">oce.colors9A</span>(<span class="dv">120</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">300</span>,<span class="dv">1700</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">400</span>,<span class="dv">1600</span>,<span class="dv">200</span>))<span class="sc">+</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">%+replace%</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">colour =</span> <span class="dv">1</span>), <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>())<span class="sc">+</span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="fu">expression</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}),</span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> <span class="fl">0.5</span>, </span>
<span id="cb86-40"><a href="#cb86-40" aria-hidden="true" tabindex="-1"></a>                               <span class="at">direction =</span> <span class="st">"vertical"</span>,</span>
<span id="cb86-41"><a href="#cb86-41" aria-hidden="true" tabindex="-1"></a>                               <span class="at">reverse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb86-42"><a href="#cb86-42" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barwidth =</span> <span class="fu">unit</span>(.<span class="dv">4</span>, <span class="st">"cm"</span>),</span>
<span id="cb86-43"><a href="#cb86-43" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="fu">unit</span>(<span class="dv">4</span>, <span class="st">"cm"</span>)))<span class="sc">+</span></span>
<span id="cb86-44"><a href="#cb86-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb86-45"><a href="#cb86-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">raster =</span> <span class="cn">FALSE</span>, <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb86-46"><a href="#cb86-46" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>), </span>
<span id="cb86-47"><a href="#cb86-47" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb86-48"><a href="#cb86-48" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb86-49"><a href="#cb86-49" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title =</span> <span class="fu">expression</span>(Primary<span class="sc">~</span>Productivity<span class="sc">~</span>(Cm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>}<span class="sc">~</span>yr<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Once we have the <strong>ggplot2</strong> objects, we can now combine them side by side with the <code>cowplot::plot_grid()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>cowplot<span class="sc">::</span><span class="fu">plot_grid</span>(mafia.pp, </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                   zanzibar.pp, </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">nrow =</span> <span class="dv">1</span>, </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">rel_widths =</span> <span class="fu">c</span>(.<span class="dv">8</span>,<span class="dv">1</span>), </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Mafia"</span>, <span class="st">"Zanzibar"</span>), </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label_x =</span> <span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">001</span>), </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label_y =</span> .<span class="dv">98</span>, </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label_fontface =</span> <span class="st">"plain"</span>, </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">label_size =</span> <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>profile <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(station <span class="sc">==</span> <span class="st">"st2"</span>)</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure)) <span class="sc">+</span> </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This produce a scatterplot shown in figure @ref(fig:), which shows a strong correlation as the water depth increase the temperature decrease. Using the *grammar of graphics<strong> of the </strong>ggplot2**, the structure of the code used to make figure @ref(fig:) is defined by;</p>
<ul>
<li>Data: <code>profile</code>,</li>
<li>Aesthetic mapping: <code>temperature</code> values mapped to <code>x</code> position, pressure values mapped to <code>y</code> position</li>
<li>Geometry: <code>points</code></li>
</ul>
<p>In <strong>ggplot2</strong>, a plot is created with the <code>ggplot()</code> function, where data and aesthetic mappings are supplied as arguments, then layers are added on with <code>+</code>.</p>
</section>
</section>
<section id="colour" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="colour"><span class="header-section-number">6.9</span> Colour</h2>
<p>The aesthetic component in <strong>ggplot2</strong> allows to add additional variables to a graph. For instance, We can map the colors of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> pressure, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">col =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="size" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="size"><span class="header-section-number">6.10</span> size</h2>
<p>The aesthetic component in <strong>ggplot2</strong> also allows to distinguish the plot with <code>size</code> of the variableh. For instance, We can map the size of the points to the temperature variable to reveal the gradient of dissolved oxygen as a function of depth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile <span class="sc">%&gt;%</span> <span class="fu">sample_frac</span>(.<span class="dv">25</span>), </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">col =</span> oxygen, <span class="at">size =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although we can map the temperature profile as points, it is appropriate to plot this profile as line. We can replace the <code>geom_point()</code> with <code>geom_path()</code> for that purpose</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">col =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="scaling" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="scaling"><span class="header-section-number">6.11</span> scaling</h2>
<p>A scale controls the mapping from data to aesthetic attributes. Its recommended to manipulate the scale for every aesthetic used on a plot. For example we want the x-axis labels to be position at the top and reverse the y-axis. The code can be writeen as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">col =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">name =</span> <span class="st">"Pressure [m]"</span>, </span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We might want to change the default color provided with <strong>ggplot2</strong> on the legend. Since we commanded the plot to display gradient colors from dissolved oxygen, We use the <code>scale_color_gradientn()</code> function. The code can be writeen as;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">col =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">name =</span> <span class="st">"Pressure [m]"</span>, </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">rainbow</span>(<span class="dv">11</span>) <span class="sc">%&gt;%</span> <span class="fu">rev</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="guides" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="guides"><span class="header-section-number">6.12</span> Guides</h2>
<p>Context is provided by <em>guides</em>. A guide help a human reader to understand the meaning of the visual cues. For example</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> profile, </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">col =</span> oxygen)) <span class="sc">+</span> </span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>()<span class="sc">+</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">name =</span> <span class="st">"Pressure [m]"</span>, </span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">810</span>,<span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>, </span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">name =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)), </span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">29</span>,<span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradientn</span>(<span class="at">colours =</span> <span class="fu">rainbow</span>(<span class="dv">11</span>) <span class="sc">%&gt;%</span> <span class="fu">rev</span>())<span class="sc">+</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># theme(legend.position = "right") +</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="st">"Dissolved oxygen (ml/L)"</span>, </span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>),</span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>                                <span class="at">barheight =</span> <span class="dv">15</span>, </span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>                                <span class="at">barwidth =</span> .<span class="dv">95</span>, </span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>                                <span class="at">title.hjust =</span> .<span class="dv">5</span>, </span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>                                <span class="at">ticks.colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>(pressure <span class="sc">==</span> <span class="dv">10</span>),</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat))<span class="sc">+</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> station))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="add-on-packages" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="add-on-packages"><span class="header-section-number">6.13</span> Add-on packages</h2>
<p>The R community has developed packages that extend the capability of <strong>ggplot2</strong>. Some of the packages include:</p>
<ul>
<li><strong>metR</strong>: Provide addition tools for plotting filled contour, and label contour lines</li>
<li><strong>ggrepel</strong>: Contains tools for automatically position non-overlapping text labels</li>
<li><strong>ggspatial</strong>: Spatial Data Framework for <strong>ggplot2</strong></li>
<li><strong>RcolorBrewer</strong>: Contains color palettes for continuous and discrete plots</li>
<li><strong>cowplot</strong>: Contains addition themes and tools to combine <strong>ggplot2</strong> plots in one panel</li>
<li><strong>egg</strong>: Provide tools for plot aligning and symmetrised <strong>ggplot2</strong> plots</li>
<li><strong>oce</strong>: Provide color pallete for visualization of Oceanographic Data</li>
<li><strong>ggsn</strong>: Provide tools for mapping North symbols and scale bars on maps created with <strong>ggplot2</strong></li>
<li><strong>gganimate</strong>: convert static ggplot2 plots to animations</li>
<li><strong>ggformula</strong>: adds some additional plot options to <strong>ggplot2</strong></li>
<li><strong>sf</strong> : Add capabilities of <strong>ggplot2</strong> to map spatial data such as simple features</li>
<li><strong>ggthemes</strong>: contains extra themes, scales, and geoms, and functions for and related to ggplot2</li>
<li><strong>ggridges</strong>: extend the geom_density function by plotiing closed polygons insted of ridgelines</li>
</ul>
</section>
<section id="ggridges" class="level2" data-number="6.14">
<h2 data-number="6.14" class="anchored" data-anchor-id="ggridges"><span class="header-section-number">6.14</span> ggridges</h2>
<p>Althoug ehe <strong>ggridges</strong> package provides <code>geom_ridgeline</code> and <code>geom_density_ridges</code>, we focus on the latter because it has ability to estimates data densities and then draws those using ridgelines.The geom <code>geom_density_ridges</code> calculates density estimates from the provided data and then plots those, using the ridgeline visualization.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>ctd <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">strata =</span> <span class="fu">cut</span>(<span class="at">x =</span> pressure, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">120</span>,<span class="dv">200</span>), </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Upper"</span>, <span class="st">"Middle"</span>, <span class="st">"Lower"</span>)))</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>ctd.strata <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> </span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(strata, pressure, lon,lat) <span class="sc">%&gt;%</span> </span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">temperature =</span> <span class="fu">mean</span>(temperature, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">salinity =</span> <span class="fu">mean</span>(salinity, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">oxygen =</span> <span class="fu">mean</span>(oxygen, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">fluorescence =</span> <span class="fu">mean</span>(fluorescence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(strata))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'strata', 'pressure', 'lon'. You can
override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.strata, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> strata))<span class="sc">+</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges2</span>()<span class="sc">+</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Middle"</span>, <span class="st">"Upper"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.41</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Trailing tails can be cut off using the <code>rel_min_height()</code> aesthetic. This aesthetic sets a percent cutoff relative to the highest point of any of the density curves. A value of 0.01 usually works well, but you may have to modify this parameter for different datasets.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.strata, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> strata))<span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges2</span>(<span class="at">rel_min_height =</span> <span class="fl">0.01</span>)<span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Middle"</span>, <span class="st">"Upper"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.41</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.strata, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> strata))<span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges2</span>(<span class="at">scale =</span> <span class="dv">8</span>,<span class="at">rel_min_height =</span> <span class="fl">0.01</span>)<span class="sc">+</span><span class="co"># scale =80, substantial overlap</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Middle"</span>, <span class="st">"Upper"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.41</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 7 rows containing non-finite values (stat_density_ridges).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="varying-fill-colors-along-the-x-axis" class="level2" data-number="6.15">
<h2 data-number="6.15" class="anchored" data-anchor-id="varying-fill-colors-along-the-x-axis"><span class="header-section-number">6.15</span> Varying fill colors along the x axis</h2>
<p>Sometimes we would like to have the area under a ridgeline not filled with a single solid color but rather with colors that vary in some form along the x axis. This effect can be achieved with the geoms geom_ridgeline_gradient and geom_density_ridges_gradient. Both geoms work just like geom_ridgeline and geom_density_ridges, except that they allow for varying fill colors. However, they do not allow for alpha transparency in the fill. For technical reasons, we can have changing fill colors or transparency but not both.</p>
<p>Here is a simple example of changing fill colors with geom_ridgeline_gradient:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.strata, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> strata,  <span class="at">fill =</span> strata))<span class="sc">+</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">5</span>,<span class="at">rel_min_height =</span> <span class="fl">0.01</span>)<span class="sc">+</span><span class="co"># scale =5, substantial overlap</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Middle"</span>, <span class="st">"Upper"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.41</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ctd.strata, <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> strata,  <span class="at">fill =</span> ..x..))<span class="sc">+</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  ggridges<span class="sc">::</span><span class="fu">geom_density_ridges_gradient</span>(<span class="at">scale =</span> <span class="dv">5</span>,<span class="at">rel_min_height =</span> <span class="fl">0.01</span>)<span class="sc">+</span><span class="co"># scale =5, substantial overlap</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"Lower"</span>, <span class="st">"Middle"</span>, <span class="st">"Upper"</span>))<span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oce.colorsTemperature</span>(<span class="dv">120</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">14</span>,<span class="dv">26</span>,<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span><span class="fu">expression</span>(Temperature<span class="sc">~</span><span class="er">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>,</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>, <span class="at">raster =</span> <span class="cn">TRUE</span>,</span>
<span id="cb109-8"><a href="#cb109-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb109-9"><a href="#cb109-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb109-10"><a href="#cb109-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> .<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Picking joint bandwidth of 0.41</code></pre>
</div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="metr" class="level2" data-number="6.16">
<h2 data-number="6.16" class="anchored" data-anchor-id="metr"><span class="header-section-number">6.16</span> metR</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>transect2 <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> <span class="fu">filter</span>( lat <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">8</span> <span class="sc">&amp;</span>lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">6</span> <span class="sc">&amp;</span>  pressure <span class="sc">&lt;</span> <span class="dv">205</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> transect2,</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> pressure, <span class="at">z =</span> fluorescence))<span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># metR::geom_contour2()+</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">205</span>,<span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> transect2 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(lon) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(), </span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LonLabel</span>(transect2 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(lon) <span class="sc">%&gt;%</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>                                               <span class="fu">pull</span>()<span class="sc">%&gt;%</span><span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">2</span>)))<span class="sc">+</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oceColors9A</span>(<span class="dv">120</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,.<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span><span class="fu">expression</span>(Chlorophyll<span class="sc">~</span>concentration<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})),</span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>,</span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>, <span class="at">raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> .<span class="dv">95</span>))<span class="sc">+</span></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Water depth [m]"</span>)<span class="sc">+</span></span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> transect2 <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(lon) <span class="sc">%&gt;%</span> <span class="fu">pull</span>(), </span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">col =</span> <span class="st">"ivory"</span>)<span class="sc">+</span></span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>), <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>depth  <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>algoa <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(depth)){</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>strata <span class="ot">=</span> ctd <span class="sc">%&gt;%</span> </span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(lon <span class="sc">&gt;</span> <span class="fl">39.3</span> <span class="sc">&amp;</span> lon <span class="sc">&lt;</span> <span class="fl">40.5</span> <span class="sc">&amp;</span> lat <span class="sc">&gt;=</span> <span class="sc">-</span><span class="dv">10</span> <span class="sc">&amp;</span> pressure <span class="sc">==</span> depth[i]) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>Lon <span class="ot">=</span> strata <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lon)</span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>Lat <span class="ot">=</span> strata <span class="sc">%&gt;%</span> <span class="fu">pull</span>(lat)</span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> strata <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">7</span>)</span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="fu">seq_along</span>(data)){</span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>  algoa.interp <span class="ot">=</span> strata <span class="sc">%$%</span> oce<span class="sc">::</span><span class="fu">interpBarnes</span>(<span class="at">x =</span> Lon, <span class="at">y =</span> Lat, <span class="at">z =</span> data[j]<span class="sc">%&gt;%</span> <span class="fu">pull</span>())</span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a>  algoa.tb <span class="ot">=</span> algoa.interp <span class="sc">%$%</span> </span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">matrix_tb</span>(<span class="at">x =</span> xg, <span class="at">y =</span> yg, <span class="at">data =</span> zg) <span class="sc">%&gt;%</span> </span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">lon =</span> x, <span class="at">lat =</span> y) <span class="sc">%&gt;%</span> </span>
<span id="cb112-21"><a href="#cb112-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">colnames</span>(data[j]), <span class="at">pressure =</span> depth[i])</span>
<span id="cb112-22"><a href="#cb112-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb112-23"><a href="#cb112-23" aria-hidden="true" tabindex="-1"></a>  algoa <span class="ot">=</span> algoa <span class="sc">%&gt;%</span> <span class="fu">bind_rows</span>(algoa.tb)</span>
<span id="cb112-24"><a href="#cb112-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb112-25"><a href="#cb112-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-26"><a href="#cb112-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-27"><a href="#cb112-27" aria-hidden="true" tabindex="-1"></a><span class="co"># algoa  %&gt;% group_by(pressure, variable) %&gt;% summarise(average = mean(value, na.rm = TRUE))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> algoa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"fluorescence"</span>),</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oceColors9A</span>(<span class="dv">120</span>))<span class="sc">+</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LatLabel</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="sc">+</span></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>), </span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LonLabel</span>(<span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pressure)<span class="sc">+</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span><span class="fu">expression</span>(Chlorophyll<span class="sc">~</span>concentration<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})),</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>,</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>, <span class="at">raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> .<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> algoa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"temperature"</span>),</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oceColors9A</span>(<span class="dv">120</span>))<span class="sc">+</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LatLabel</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="sc">+</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>), </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LonLabel</span>(<span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pressure)<span class="sc">+</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span><span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)),</span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>,</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>, <span class="at">raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> .<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">data =</span> algoa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(variable <span class="sc">==</span> <span class="st">"oxygen"</span>),</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> lat, <span class="at">z =</span> value), <span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oceColors9A</span>(<span class="dv">120</span>))<span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>), </span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LatLabel</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="fl">8.5</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="fl">2.5</span>)))<span class="sc">+</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> <span class="fu">round</span>(<span class="dv">2</span>), </span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> metR<span class="sc">::</span><span class="fu">LonLabel</span>(<span class="fu">seq</span>(<span class="fl">39.55</span>,<span class="fl">40.25</span>,<span class="at">length.out =</span> <span class="dv">3</span>)))<span class="sc">+</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>pressure)<span class="sc">+</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>)<span class="sc">+</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>))<span class="sc">+</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span><span class="fu">expression</span>(Dissolved<span class="sc">~</span>oxygen<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})),</span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>,</span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>, <span class="at">raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">15</span>, <span class="at">barwidth =</span> .<span class="dv">95</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="plotting_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<hr>
</section>
<section id="a-grammar-for-graphics" class="level2" data-number="6.17">
<h2 data-number="6.17" class="anchored" data-anchor-id="a-grammar-for-graphics"><span class="header-section-number">6.17</span> A grammar for graphics</h2>
<p>In this section, we will create some of the most routinely used plots to explore data using the <code>geom_</code> functions.</p>
<p>We will use the following libraries in this post:</p>
<ul>
<li><strong>readr</strong></li>
<li><strong>ggplot2</strong></li>
<li><strong>tibble</strong></li>
<li><strong>dplyr</strong></li>
</ul>
<p>Which are part of the tidyverse. By loading the tidyverse, we also load all the packages mentioned above</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(tidyverse)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(patchwork)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(magrittr)</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">11</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>All the data sets used in this post can be found here and code can be downloaded from <a href="www.">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>octopus <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"assets/octopus_data.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The variables representing the <code>X</code> and <code>Y</code> axis can be specified either in <code>ggplot()</code> or in <code>geom_point()</code>. We will learn to modify the appearance of the points in a different post.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter1-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.4: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
<section id="regression-line" class="level3" data-number="6.17.1">
<h3 data-number="6.17.1" class="anchored" data-anchor-id="regression-line"><span class="header-section-number">6.17.1</span> Regression Line</h3>
<p>You can fit the regression on the scatterplot with <code>geom_smooth()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>lm <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"linear model"</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>gam <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"GAM"</span>)</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>loess <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"loess"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">title =</span> <span class="st">"LOESS"</span>)</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>lm <span class="sc">+</span> gam <span class="sc">+</span> loess</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter-models" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter-models-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure 6.5: Relationship between total length and weight of octopus for Linear, GAM and LOESS models</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="horizontal-vertical-lines" class="level3" data-number="6.17.2">
<h3 data-number="6.17.2" class="anchored" data-anchor-id="horizontal-vertical-lines"><span class="header-section-number">6.17.2</span> Horizontal/ vertical lines</h3>
<p>A segment of horizontal or vertical line can be added on the plot using egg::ggarrange</p>
<section id="vertical-line" class="level4" data-number="6.17.2.1">
<h4 data-number="6.17.2.1" class="anchored" data-anchor-id="vertical-line"><span class="header-section-number">6.17.2.1</span> Vertical Line</h4>
<p>For the vertical line, the <code>x</code> axis intercept must be specified in <code>geom_vline()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">100</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatterV" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatterV-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.6: Relationship between total length and weight of octopus and vertical line</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vertical-line-1" class="level4" data-number="6.17.2.2">
<h4 data-number="6.17.2.2" class="anchored" data-anchor-id="vertical-line-1"><span class="header-section-number">6.17.2.2</span> Vertical Line</h4>
<p>In similar manner, for the horizontal line, the <code>y</code> axis intercept must be specified in <code>geom_hline()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">2</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">size =</span> .<span class="dv">5</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatterH" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatterH-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.7: Relationship between total length and weight of octopus and horizontal line</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="aes" class="level2" data-number="6.18">
<h2 data-number="6.18" class="anchored" data-anchor-id="aes"><span class="header-section-number">6.18</span> aes()</h2>
<p>In this section, we focus on the <code>aesthetics</code> i.e.&nbsp;color, shape, size, alpha, line type, line width etc. We can map these to variables or specify values for them. If we want to map the above to variables, we have to specify them within the <code>aes()</code> function. We will look at both methods in the following sections.</p>
<p>Explore aesthetics such as</p>
<ul>
<li>color</li>
<li>shape</li>
<li>size</li>
<li>fill</li>
<li>alpha</li>
<li>width</li>
</ul>
<section id="color" class="level3" data-number="6.18.1">
<h3 data-number="6.18.1" class="anchored" data-anchor-id="color"><span class="header-section-number">6.18.1</span> Color</h3>
<p>In <strong>ggplot2</strong>, when we mention color or colour, it usually refers to the color of the geoms. The <code>fill</code> argument is used to specify the color of the shapes in certain cases. In this section, we will see how we can specify the color for the different geoms we learnt in the previous post.</p>
<p>For points, the color argument specifies the color of the point for certain shapes and border for others. The fill argument is used to specify the background for some shapes and will not work with other shapes. Let us look at an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight, <span class="at">col =</span> sex)) <span class="sc">+</span> </span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter2-1.png" class="img-fluid figure-img" width="288"></p>
<p></p><figcaption class="figure-caption">Figure 6.8: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>If you do not want to map a variable to color, you can specify it separately using the color argument but in this case it should be outside the aes() function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight, <span class="at">col =</span> sex)) <span class="sc">+</span> </span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col =</span> <span class="st">"blue"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter3-1.png" class="img-fluid figure-img" width="288"></p>
<p></p><figcaption class="figure-caption">Figure 6.9: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="shape" class="level3" data-number="6.18.2">
<h3 data-number="6.18.2" class="anchored" data-anchor-id="shape"><span class="header-section-number">6.18.2</span> shape</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight, <span class="at">shape =</span> sex)) <span class="sc">+</span> </span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter4-1.png" class="img-fluid figure-img" width="288"></p>
<p></p><figcaption class="figure-caption">Figure 6.10: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Let us map size of points to a variable. It is advised to map size only to continuous variables and not categorical variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight, <span class="at">col =</span> sex, <span class="at">size =</span> dml)) <span class="sc">+</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter5-1.png" class="img-fluid figure-img" width="288"></p>
<p></p><figcaption class="figure-caption">Figure 6.11: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="axis-and-labels" class="level2" data-number="6.19">
<h2 data-number="6.19" class="anchored" data-anchor-id="axis-and-labels"><span class="header-section-number">6.19</span> Axis and labels</h2>
<p>In this section, we learn about about aesthetic and focus on</p>
<ul>
<li>add title and subtitle to the plot</li>
<li>modify axis labels</li>
<li>modify axis range</li>
<li>remove axis format axis</li>
</ul>
<p>Let us start with a simple scatter plot. We will continue to use the octopus data set and examine the relationship between total length and body weight using <code>geom_point()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>oct <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We add the axis labels, title and subtitle for the plot using the <code>labs()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (cm)"</span>, <span class="at">y =</span> <span class="st">"Weight (g)"</span>, </span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Octopus"</span>, <span class="at">subtitle =</span> <span class="st">"The total length and body weight of octopus"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatter6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter6-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.12: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="axis-range" class="level2" data-number="6.20">
<h2 data-number="6.20" class="anchored" data-anchor-id="axis-range"><span class="header-section-number">6.20</span> Axis Range</h2>
<p>Often times, you may want to modify the range of the axis value. In <strong>ggplot2</strong>, we can achieve this using <code>scale_</code>function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Total length (cm)"</span>, <span class="at">y =</span> <span class="st">"Weight (g)"</span>, </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Octopus"</span>, <span class="at">subtitle =</span> <span class="st">"The total length and body weight of octopus"</span>)<span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">30</span>,<span class="dv">180</span>,<span class="dv">30</span>))<span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatter7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter7-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.13: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Sometimes the axis label become a reduntat</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatter8" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter8-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.14: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="text-annotaion" class="level2" data-number="6.21">
<h2 data-number="6.21" class="anchored" data-anchor-id="text-annotaion"><span class="header-section-number">6.21</span> Text annotaion</h2>
<p>Annotation help to add custom text to the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>) <span class="sc">+</span> </span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="at">geom =</span> <span class="st">"text"</span>, <span class="at">x =</span> <span class="dv">20</span>, <span class="at">y =</span> <span class="fl">2.2</span>, <span class="at">label =</span> <span class="st">"outlier"</span>, <span class="at">color =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-scatter9" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter9-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.15: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scales" class="level2" data-number="6.22">
<h2 data-number="6.22" class="anchored" data-anchor-id="scales"><span class="header-section-number">6.22</span> Scales</h2>
<p>Whenever you specify an aesthetic mapping, <strong>ggplot2</strong> uses a particular scale to determine the range of values that the data encoding should be mapped to. However, there times you need to customize the scale. <strong>ggplot2</strong> has <code>scales_*()</code> function that allows to modify titles, labels, limits, breaks and position of the axis. Each scale can be represented by a function named in the following format: <code>scale_</code>, followed by the name of the aesthetic property (e.g., x or color), followed by an <code>_</code> and the type of the scale (e.g., continuous or discrete). A continuous scale will handle values such as numeric data (where there is a continuous set of numbers), whereas a discrete scale will handle values such as colors (since there is a small discrete list of distinct colors). In simple language, the x and y-axis of a continuous data is modified with the <code>scale_x_continuous()</code> and <code>scale_y_continuous()</code> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> octopus, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> tl, <span class="at">y =</span> weight)) <span class="sc">+</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"gam"</span>, <span class="at">se =</span> <span class="cn">TRUE</span>)<span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">150</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">50</span>,<span class="dv">150</span>,<span class="dv">20</span>))<span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(.<span class="dv">5</span>, <span class="dv">3</span>, .<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-scatter10" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-scatter10-1.png" class="img-fluid figure-img" width="240"></p>
<p></p><figcaption class="figure-caption">Figure 6.16: Relationship between total length and weight of octopus</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The x and y-axis of a continuous data is modified with the <code>scale_x_discrete()</code> and <code>scale_y_continuous()</code> functions.</p>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mafia.chl.season , <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl))<span class="sc">+</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"NE"</span>, <span class="st">"IN"</span>, <span class="st">"SE"</span>))<span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.5</span>,.<span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-box-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption">Figure 6.17: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>when the data has been transformed, for instance because of the low value, chlorophyll-a are often stretched with the log-tranformation for visual appeal. But the log-transformed values make no sense about concentration and hence the real values must replace them. We can change the tick labels using the labels argument. When adding labels, tick breaks and labels must have the same length.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mafia.chl.season , <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl <span class="sc">%&gt;%</span> <span class="fu">log</span>()))<span class="sc">+</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"NE"</span>, <span class="st">"IN"</span>, <span class="st">"SE"</span>), </span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Inter"</span>, <span class="st">"Northeast"</span>, <span class="st">"Southeast"</span>))<span class="sc">+</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="at">length.out =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-box1-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption">Figure 6.18: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The position of the axes can be changed using the <code>position</code> argument. For instance, to move the the x-axis to the top of the plot you only need to specify <code>position = top</code> as written in code below;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mafia.chl.season , <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl <span class="sc">%&gt;%</span> <span class="fu">log</span>()))<span class="sc">+</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"NE"</span>, <span class="st">"IN"</span>, <span class="st">"SE"</span>), </span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Inter"</span>, <span class="st">"Northeast"</span>, <span class="st">"Southeast"</span>))<span class="sc">+</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="at">length.out =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-box3-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption">Figure 6.19: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Fill the boxplot with season to specify the colors and arrange the colors manual with <code>scale_fill_manual()</code> function as written below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mafia.chl.season , <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl <span class="sc">%&gt;%</span> <span class="fu">log</span>(), <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"NE"</span>, <span class="st">"IN"</span>, <span class="st">"SE"</span>), </span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Inter"</span>, <span class="st">"Northeast"</span>, <span class="st">"Southeast"</span>))<span class="sc">+</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="at">length.out =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-box4-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption">Figure 6.20: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Note the order of layers matter here: you <code>scale_fill_manual()</code> function must start before <code>scale_x_discrete()</code> function. Otherwise the colours you specify mismatch with legend colors as shown</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mafia.chl.season , <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> chl <span class="sc">%&gt;%</span> <span class="fu">log</span>(), <span class="at">fill =</span> season))<span class="sc">+</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( <span class="at">outlier.colour =</span> <span class="st">"red"</span>, <span class="at">outlier.shape =</span> <span class="dv">8</span>, <span class="at">outlier.size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">position =</span> <span class="st">"top"</span>,</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">limits =</span> <span class="fu">c</span>(<span class="st">"NE"</span>, <span class="st">"IN"</span>, <span class="st">"SE"</span>), </span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Inter"</span>, <span class="st">"Northeast"</span>, <span class="st">"Southeast"</span>))<span class="sc">+</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>))<span class="sc">+</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="at">length.out =</span> <span class="dv">5</span>),</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="fl">2.6</span>,<span class="at">length.out =</span> <span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-box5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-box5-1.png" class="img-fluid figure-img" width="384"></p>
<p></p><figcaption class="figure-caption">Figure 6.21: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell">

</div>
<p>The <code>scale_*_reverse()</code> allows to reverse the order of the axis. For instance, when plotting profiles, we reverse y-xis and position the label of x-axis at the top</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> algoa.average, </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">y =</span> pressure))<span class="sc">+</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_x"</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-profile" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-profile-1.png" class="img-fluid figure-img" width="576"></p>
<p></p><figcaption class="figure-caption">Figure 6.22: Chloropphyll concentration by monsoon seasons</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guides-1" class="level2" data-number="6.23">
<h2 data-number="6.23" class="anchored" data-anchor-id="guides-1"><span class="header-section-number">6.23</span> Guides</h2>
<p><code>guides()</code> helps to set, modify and remove legend for a specific aesthetic. It has two functions—<code>guide_legend()</code> or <code>guide_colorbar()</code>. Let make a section plot of the fluorescence with the default options for the legend</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>section <span class="ot">=</span><span class="fu">ggplot</span>(<span class="at">data =</span> algoa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">10</span>),</span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> lon, <span class="at">y =</span> pressure, <span class="at">z =</span> fluorescence)) <span class="sc">+</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour_fill</span>(<span class="at">na.fill =</span> <span class="cn">TRUE</span>, <span class="at">bins =</span> <span class="dv">60</span>) <span class="sc">+</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">scale_x_longitude</span>(<span class="at">ticks =</span> .<span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">200</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="at">colours =</span> oce<span class="sc">::</span><span class="fu">oce.colors9A</span>(<span class="dv">120</span>), </span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.15</span>,<span class="fl">1.25</span>, <span class="at">length.out =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span><span class="fu">round</span>(<span class="dv">2</span>))<span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Section of oxygen along latitude"</span>, metR<span class="sc">::</span><span class="fu">LatLabel</span>(<span class="sc">-</span><span class="fl">10.54</span>)))<span class="sc">+</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">expand =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">180</span>,<span class="dv">15</span>))</span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>section</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-section" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-section-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 6.23: Chloropphyll concentration along the longitudinal section of Rufiji Mafia</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can add the contour labels and remove the legend in a graph</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>section <span class="sc">+</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour2</span>(<span class="at">bins =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..level..)) <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># metR::geom_text_contour() +</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-section1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-section1-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 6.24: Chloropphyll concentration along the longitudinal section of Rufiji Mafia overlaid with labelled contour</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The <code>guide_colorbar()</code> modify the look and appearance of the legend to smooth colorbar. for instane the code of lines below highlight the key arguments that one has to specify to modify the legend of colorbar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>section <span class="sc">+</span>  </span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour2</span>(<span class="at">bins =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..level..)) <span class="sc">+</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_colorbar</span>(<span class="at">title =</span> <span class="fu">expression</span>(Chlorophyll<span class="sc">~</span>concentration<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.position =</span> <span class="st">"right"</span>, </span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>                               <span class="at">title.hjust =</span> .<span class="dv">5</span>,</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.position =</span> <span class="st">"right"</span>,</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label.vjust =</span> <span class="fl">0.5</span>,</span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>                               <span class="at">raster =</span> <span class="cn">FALSE</span>,</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>                               <span class="at">nbin =</span> <span class="dv">12</span>,</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>                               <span class="at">reverse =</span> <span class="cn">FALSE</span>,</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barwidth =</span> <span class="fl">1.1</span>, </span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>                               <span class="at">barheight =</span> <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-section2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-section2-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 6.25: Chloropphyll concentration along the longitudinal section of Rufiji Mafia</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>If you want the legend to appear as individual key, use <code>guide_colorbar()</code> as written in the code below</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>section <span class="sc">+</span>  </span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  metR<span class="sc">::</span><span class="fu">geom_contour2</span>(<span class="at">bins =</span> <span class="dv">4</span>, <span class="fu">aes</span>(<span class="at">label =</span> ..level..)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="fu">expression</span>(Chlorophyll<span class="sc">~</span>concentration<span class="sc">~</span>(mgm<span class="sc">^</span>{<span class="sc">-</span><span class="dv">3</span>})), </span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title.position =</span> <span class="st">"top"</span>, </span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">13</span>),</span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">title.hjust =</span> .<span class="dv">5</span>,<span class="at">nrow =</span> <span class="dv">1</span>,</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">reverse =</span> <span class="cn">FALSE</span>, </span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>                             <span class="at">keywidth =</span> <span class="fl">3.</span>, <span class="at">keyheight =</span> .<span class="dv">8</span>,</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>                             <span class="at">direction =</span> <span class="st">"horizontal"</span>,</span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label.theme =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">label.position =</span> <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-section3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-section3-1.png" class="img-fluid figure-img" width="480"></p>
<p></p><figcaption class="figure-caption">Figure 6.26: Chloropphyll concentration along the longitudinal section of Rufiji Mafia</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="themes" class="level2" data-number="6.24">
<h2 data-number="6.24" class="anchored" data-anchor-id="themes"><span class="header-section-number">6.24</span> Themes</h2>
<p>Themes in <strong>ggplot</strong> modify the appearance of all non data compoments in the plot like: axis, legend, panel, plot area, background, margin, facets etc. Let’s create a profile plot of temperature with default theme settings</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>profile <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> algoa <span class="sc">%&gt;%</span> <span class="fu">filter</span>(lat <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">10</span>), </span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> temperature, <span class="at">y =</span> pressure, <span class="at">color =</span> station))<span class="sc">+</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_path</span>() <span class="sc">+</span> </span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_reverse</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">800</span>,<span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">position =</span> <span class="st">"top"</span>) <span class="sc">+</span></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Pressure [m]"</span>,<span class="at">x =</span> <span class="fu">expression</span>(Temperature<span class="sc">~</span>(degree<span class="sc">*</span>C)))</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>profile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.27: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>We can modify the size and color of axis label with the <code>axis.text()</code> and axis title with <code>axis.title()</code> functions. You can use <code>axis.title.y</code> to modify the Y axis title and to modify the title of both the axis together, <code>use axis.title</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof1-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.28: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>To modify the appearance of the axis ticks, use the <code>axis.ticks_*</code> argument. You can change the color, size, linetype and length of the ticks using the <code>element_line()</code> function as shown below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>,  <span class="st">"cm"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof3-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.29: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The <code>panel_grid</code> argument is used to modify the appearance of the gridlines. You can change the color, size and linetype of the line using the element_line() function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>,  <span class="st">"cm"</span>),</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey60"</span>, <span class="at">linetype =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof4-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.30: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The background of the legend can be modified using the legend.background argument. You can change the background color, the border color and line type using <code>element_rect()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>,  <span class="st">"cm"</span>),</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey60"</span>, <span class="at">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof5-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.31: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Now, let us look at modifying the non-data components of a legend.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>,  <span class="st">"cm"</span>),</span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey60"</span>, <span class="at">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),</span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof6" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof6-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.32: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The appearance of the text can be modified using the legend.text argument. You can change the color, size and font using the element_text() function. The position and direction of the legend can be changed using <code>legend.position()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>profile <span class="sc">+</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">name =</span> <span class="st">"Stations"</span>)<span class="sc">+</span></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span>  <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">colour =</span> <span class="st">"black"</span>), </span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.length =</span> <span class="fu">unit</span>(.<span class="dv">3</span>,  <span class="st">"cm"</span>),</span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.grid =</span> <span class="fu">element_line</span>(<span class="at">colour =</span> <span class="st">"grey60"</span>, <span class="at">linetype =</span> <span class="dv">3</span>),</span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"white"</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="fu">c</span>(.<span class="dv">9</span>,.<span class="dv">3</span>),</span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="st">"white"</span>),</span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">colour =</span> <span class="st">"black"</span>),</span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">colour =</span> <span class="st">"black"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-prof7" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="plotting_files/figure-html/fig-prof7-1.png" class="img-fluid figure-img" width="336"></p>
<p></p><figcaption class="figure-caption">Figure 6.33: Temperature profile by station of deployment</figcaption><p></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-metr" class="csl-entry" role="doc-biblioentry">
Campitelli, Elio. 2021. <em>metR: Tools for Easier Analysis of Meteorological Fields</em>. <a href="https://doi.org/10.5281/zenodo.2593516">https://doi.org/10.5281/zenodo.2593516</a>.
</div>
<div id="ref-patchwork" class="csl-entry" role="doc-biblioentry">
Pedersen, Thomas Lin. 2020. <em>Patchwork: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-ggplot" class="csl-entry" role="doc-biblioentry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-cowplot" class="csl-entry" role="doc-biblioentry">
Wilke, Claus O. 2018. <em>Cowplot: Streamlined Plot Theme and Plot Annotations for ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dataManipulation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Manipulating Data with <strong>dplyr</strong></span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./eda.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Exploratory-Data-Analysis-EDA</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>